[{"authors":null,"categories":null,"content":"Atuo na área de Inteligência de Negócios (aka BI) e análise de dados desde 2015, realizando consultas em banco de dados, desenvolvimento de dashboards em ferramentas de visualização, monitoramento de data warehouse, desenvolvimento de ETLs e condução de estudos ad-hoc com uso de ferramentas estatísticas (R/R-Studio).\nEspecialidades:\n Data Warehouse: Redshift, Athena e SQL Server Data Viz: Tableau, Sisense e Qlik View Estudos ad-hoc: R Notebooks  ","date":-62135596800,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://francisco.piccolo.com/author/francisco-piccolo/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/francisco-piccolo/","section":"authors","summary":"Atuo na área de Inteligência de Negócios (aka BI) e análise de dados desde 2015, realizando consultas em banco de dados, desenvolvimento de dashboards em ferramentas de visualização, monitoramento de data warehouse, desenvolvimento de ETLs e condução de estudos ad-hoc com uso de ferramentas estatísticas (R/R-Studio).","tags":null,"title":"Francisco Piccolo","type":"authors"},{"authors":null,"categories":null,"content":"\r\r\rA Economatica é uma empresa de tecnologia do setor financeiro que fornece dados sobre empresas, fundos de investimentos e ações, que auxiliam investidores na tomada de decisão e também acadêmicos na elaboração de estudos. Recentemente comecei a elaborar um artigo acadêmico relacionado a finanças e precisei recorrer à Economatica para pegar alguns dados financeiros de empresas listadas na Bovespa.\nComo vou ter que fazer uma análise exploratória do dataset para ver o que será relevante usar no artigo, vou aproveitar para documentar esta análise e deixar o dataset disponível para que outras pessoas usem também. O dataset pode ser acessado neste link ou através do comando abaixo:\n# Pacote necessário para usar a função abaixo, que lê o arquivo no github\rlibrary(readr)\rdataset_1 \u0026lt;- readr::read_delim(file = \u0026quot;https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2021-02-27-dataset_economatica/dataset_1.csv\u0026quot;,\rdelim = \u0026quot;;\u0026quot;)\rdataset_2 \u0026lt;- readr::read_delim(file = \u0026quot;https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2021-02-27-dataset_economatica/dataset_2.csv\u0026quot;,\rdelim = \u0026quot;;\u0026quot;)\rO dataset apresenta dados de Março/2016 até Set/2020 das seguintes métricas: Receita líquida; custo de produtos vendidos (cpv); investimentos; EBITDA; Fluxo de caixa livre; Despesas operacionais; Despesas financeiras; Receitas financeiras; Empréstimos de curto prazo; Empréstimos de longo prazo; EV/EBITDA; Patrimônio Líquido; Ativo toal; Passivo + Patrimônio Líquido.\nPara esta análise, vou usar os pacotes abaixo:\nlibrary(tidyverse)\rlibrary(patchwork)\rlibrary(kableExtra)\rlibrary(DT)\r# Função para padronizar o design dos gráficos\rtheme_graph \u0026lt;- function(){\rtheme(\rplot.title = element_text(size = 14),\rplot.subtitle = element_text(size = 10),\rplot.caption = element_text(face = \u0026quot;italic\u0026quot;, size = 8.5),\raxis.text = element_text(size = 8.5),\raxis.title = element_text(face = \u0026quot;italic\u0026quot;, size = 8.5),\rstrip.background = element_rect(fill = \u0026quot;blue\u0026quot;),\rstrip.text = element_text(face = \u0026quot;bold\u0026quot;),\rlegend.position = \u0026quot;bottom\u0026quot;,\rlegend.title = element_blank()\r)\r}\rAbaixo consta uma amostra dos dados:\ndataset_1 %\u0026gt;% select(company,class,symbol,metric_name,\u0026quot;31/03/2016\u0026quot;,\u0026quot;30/06/2016\u0026quot;) %\u0026gt;% head(5) %\u0026gt;% knitr::kable()\r\r\r\rcompany\r\rclass\r\rsymbol\r\rmetric_name\r\r31/03/2016\r\r30/06/2016\r\r\r\r\r\r3r Petroleum\r\rON\r\rRRRP3\r\rnet_revenue\r\r0\r\r0\r\r\r\r524 Particip\r\rON\r\rQVQP3B\r\rnet_revenue\r\r0\r\r0\r\r\r\rAbc Brasil\r\rPN\r\rABCB4\r\rnet_revenue\r\r0\r\r0\r\r\r\rAco Altona\r\rPN\r\rEALT4\r\rnet_revenue\r\r37863\r\r69114\r\r\r\rAerisenergia\r\rON\r\rAERI3\r\rnet_revenue\r\r0\r\r0\r\r\r\r\rAgora vamos a sessão de perguntas e respostas referentes ao dataset que formará nossa análise exploratória:\nQuantidade de empresas no dataset por setor econômico.\r\rdataset_1 %\u0026gt;% distinct(economatica_classification, symbol) %\u0026gt;% group_by(economatica_classification) %\u0026gt;% summarise(count = n()) %\u0026gt;% arrange(desc(count)) -\u0026gt; df\rtotal \u0026lt;- df %\u0026gt;%\rgroup_by() %\u0026gt;% summarise(total = sum(count)) %\u0026gt;% as.data.frame()\rdf[nrow(df)+1, ] = list(\u0026quot;Total\u0026quot;,total[1,1])\rdf %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;,\rdecimal.mark = \u0026quot;,\u0026quot;))\r\r\r\reconomatica_classification\r\rcount\r\r\r\r\r\rother\r\r95\r\r\r\relectrical_energy\r\r41\r\r\r\rfinance_and_securities\r\r32\r\r\r\rretail\r\r31\r\r\r\rreal_state\r\r29\r\r\r\rtransport_and_services\r\r21\r\r\r\rtextile\r\r19\r\r\r\rsteel_industry\r\r18\r\r\r\rvehicles\r\r14\r\r\r\rfood_and_beverages\r\r12\r\r\r\rsoftware_and_data\r\r12\r\r\r\roil_and_gas\r\r11\r\r\r\rchemistry\r\r8\r\r\r\rindustry_machines\r\r7\r\r\r\rmining\r\r7\r\r\r\rtelecom\r\r6\r\r\r\reletronics\r\r5\r\r\r\ragriculture\r\r4\r\r\r\rpaper_and_cellulose\r\r4\r\r\r\rTotal\r\r376\r\r\r\r\r","date":1614384000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1614384000,"objectID":"841db8c74153298c5c249c1878f61279","permalink":"https://francisco.piccolo.com/draft/br_company_financial_data_economatica_dataset/","publishdate":"2021-02-27T00:00:00Z","relpermalink":"/draft/br_company_financial_data_economatica_dataset/","section":"draft","summary":"A Economatica é uma empresa de tecnologia do setor financeiro que fornece dados sobre empresas, fundos de investimentos e ações, que auxiliam investidores na tomada de decisão e também acadêmicos na elaboração de estudos.","tags":null,"title":"Análise Exploratória de Dados Financeiros - Dataset da Economatica","type":"draft"},{"authors":null,"categories":null,"content":"\r\rNeste post vou desenvolver e analisar diversos modelos de ‘forecasting’ que aprendi após ler livros sobre o tema. A ideia é mostrar, de maneira simples, como rodar estes modelos no R, como analisar a performance e interpretar os resultados.\nNeste trabalho eu vou usar os pacotes abaixo, que já contêm vários datasets de exemplo para desenvolvimento do ‘forecast’.\nlibrary(GGally)\rlibrary(fpp3)\rlibrary(fable)\rlibrary(tsibble)\rlibrary(tsibbledata)\rlibrary(feasts)\rlibrary(tidyverse)\rlibrary(patchwork)\rlibrary(seasonal)\rlibrary(fma)\r# Função para padronizar o design dos gráficos\rtheme_graph \u0026lt;- function(){\rtheme(\rplot.title = element_text(size = 16),\rplot.subtitle = element_text(size = 12),\rplot.caption = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\raxis.text = element_text(size = 9),\raxis.title = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\rstrip.background = element_rect(fill = \u0026quot;grey\u0026quot;),\rstrip.text = element_text(face = \u0026quot;bold\u0026quot;),\rlegend.position = \u0026quot;bottom\u0026quot;,\rlegend.title = element_blank()\r)\r}\rA lista abaixo apresenta os métodos que irei aplicar às séries temporais:\n\rAverage: Média dos valores passados.\rNaive: Último valor da série.\rSNaive: Últimos valores considerando a sazonalidade da série, ou seja, repete o padrão sazonal para o período projetado.\rDrift: Desvio entre o primeiro período (d1) e o último período da projeção. Como se fosse uma linha ligando dois pontos.\rETS: Suavização Exponencial, sendo médias ponderadas de valores passados, com o peso da média caindo com o tempo.\rArima: Busca descrever a autocorrelação na série temporal e modelar esta autocorrelação para criar as projeções.\r\rImportante notar que dentro de cada método é possível criar os modelos de previsão. No caso dos métodos ETS (também conhecido como Suavização Exponencial) e Arima, uma infinidade de modelos é possível, onde é preciso estudar a série temporal para escolher o melhor modelo.\nPara cada série temporal, irei aplicar as seguintes etapas para poder gerar uma conclusão ao final:\nAnálise exploratória da série temporal.\rSegmentação da série temporal em ‘treino’ e ‘teste’.\rAplicação dos modelos no dataset ‘treino’.\rValidação da performance.\rConclusões.\r\rAgora vamos por a mão na massa para ver se as conclusões irão valer a leitura.\nProdução Trimestral de Barro na Australia\rEsta série é obtida no dataset ‘aus_production’ do pacote ‘tsibbledata’.\nAnálise Exploratória\rtsibbledata::aus_production %\u0026gt;% select(Quarter, Bricks) %\u0026gt;%\rfilter(!is.na(Bricks)) %\u0026gt;% feasts::autoplot(Bricks)+\rtheme_graph()+\rlabs(title = \u0026quot;Produção Trimestral de Barro\u0026quot;,\rsubtitle = \u0026quot;Série sem tendência porém com forte sazonalidade\u0026quot;)\rVamos verificar a sazonalidade entre os trimestres.\ntsibbledata::aus_production %\u0026gt;% select(Quarter, Bricks) %\u0026gt;%\rfilter(!is.na(Bricks)) %\u0026gt;% feasts::gg_subseries()+\rtheme_graph()+\rlabs(title = \u0026quot;Produção em cada trimestre\u0026quot;)\rParece que os trimestres possuem uma sazonalidade estável. Vamos ver, entre um trimestre e o seguinte, a diferença percentual.\ntsibbledata::aus_production %\u0026gt;% select(Quarter, Bricks) %\u0026gt;%\rfilter(!is.na(Bricks)) %\u0026gt;% mutate(lag_bricks = lag(Bricks,1),\rperc_delta = Bricks/lag_bricks-1) %\u0026gt;% feasts::autoplot(perc_delta)+\rscale_y_continuous(labels = scales::percent)+\rlabs(title = \u0026quot;Diferença % entre um trimestre e o seguinte\u0026quot;)\rAgora vamos segmentar a série através do modelo ‘STL’ (Multiple Seasonal Decomposition by Loess). Este modelo irá decompor a série em Sazonalidade, Tendência e Resíduo.\nstl \u0026lt;- tsibbledata::aus_production %\u0026gt;% select(Quarter, Bricks) %\u0026gt;%\rfilter(!is.na(Bricks)) %\u0026gt;% fabletools::model(feasts::STL(Bricks))\r# Amostra do dataset criado após a decomposição\rfabletools::components(stl) %\u0026gt;% head(10) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r.model\rQuarter\rBricks\rtrend\rseason_year\rremainder\rseason_adjust\r\r\r\rfeasts::STL(Bricks)\r1956 Q1\r189\r204,6824\r-22,103518\r6,4210798\r211,1035\r\rfeasts::STL(Bricks)\r1956 Q2\r204\r202,2213\r3,270554\r-1,4918814\r200,7294\r\rfeasts::STL(Bricks)\r1956 Q3\r208\r200,6363\r17,262705\r-9,8990529\r190,7373\r\rfeasts::STL(Bricks)\r1956 Q4\r197\r199,8118\r1,654780\r-4,4665777\r195,3452\r\rfeasts::STL(Bricks)\r1957 Q1\r187\r204,2528\r-22,264318\r5,0114886\r209,2643\r\rfeasts::STL(Bricks)\r1957 Q2\r214\r209,4834\r3,256947\r1,2596320\r210,7431\r\rfeasts::STL(Bricks)\r1957 Q3\r227\r213,7849\r17,418423\r-4,2033676\r209,5816\r\rfeasts::STL(Bricks)\r1957 Q4\r222\r217,4343\r1,683168\r2,8825771\r220,3168\r\rfeasts::STL(Bricks)\r1958 Q1\r199\r222,0642\r-22,424785\r-0,6394626\r221,4248\r\rfeasts::STL(Bricks)\r1958 Q2\r229\r226,2032\r3,249909\r-0,4531573\r225,7501\r\r\r\rCom este dataset da série decomposta, podemos plotar para ver qual “segmento” é mais forte (uma validação visual).\nfabletools::components(stl) %\u0026gt;% feasts::autoplot()+\rtheme_graph()+\rlabs(title = \u0026quot;Série decomposta\u0026quot;,\rsubtitle = \u0026quot;Sazonalidade entre um trimeste e o seguinte\u0026quot;)\rSabendo que a série tem este comportamento sazonal e uma certa tendência, podemos testar alguns modelos para ver qual irá ter a melhor performance.\n\rSegmentação em Treino e Teste\rO dataset vai de 1956/Q1 até 2005/Q2. Para o treino, vou pegar o período de 1956/Q1 até 1999/Q4, e depois irei fazer o teste no período restante para depois fazer a comparação com os valores reais.\n# Dataset de teste\rtsibbledata::aus_production %\u0026gt;% select(Quarter, Bricks) %\u0026gt;%\rfilter(!is.na(Bricks),\ryear(Quarter) \u0026lt;= \u0026quot;1999\u0026quot;) -\u0026gt; train_dataset\rtsibbledata::aus_production %\u0026gt;% select(Quarter, Bricks) %\u0026gt;%\rfilter(!is.na(Bricks),\ryear(Quarter) \u0026gt; \u0026quot;1999\u0026quot;) -\u0026gt; test_dataset\r\rDesenvolvimento dos Modelos\rPara os modelos ‘Mean’, ‘Naive’, ‘Snaive’ e ‘Drift’, não é preciso ajustar parâmetros para se adequar à série temporal. Porém nos modelos do tipo ‘Exponential Smoothing’ e ‘Arima’ este ajuste se faz necessário. O ajuste que farei será para levar em consideração a sazonalidade da série temporal.\n# Criando os modelos\rmodel_fit \u0026lt;- train_dataset %\u0026gt;% model(\rmean = fable::MEAN(Bricks),\rnaive = fable::NAIVE(Bricks),\rsnaive = fable::SNAIVE(Bricks),\rdrift = fable::RW(Bricks ~ drift()),\rsimp_exp_smooth = fable::ETS(Bricks ~ error(\u0026quot;A\u0026quot;) + trend(\u0026quot;N\u0026quot;) + season(\u0026quot;A\u0026quot;)),\rholt_linear_trend = fable::ETS(Bricks ~ error(\u0026quot;A\u0026quot;) + trend(\u0026quot;A\u0026quot;) + season(\u0026quot;N\u0026quot;)),\rholt_damped_trend = fable::ETS(Bricks ~ error(\u0026quot;A\u0026quot;) + trend(\u0026quot;Ad\u0026quot;, phi = .9) + season(\u0026quot;A\u0026quot;)),\rholt_winter_season_add = fable::ETS(Bricks ~ error(\u0026quot;A\u0026quot;) + trend(\u0026quot;A\u0026quot;) + season(\u0026quot;A\u0026quot;))\r)\r# Gerando as previsões para os próximos 22 períodos (quarters), até 2005 Q2\rforecasting \u0026lt;- model_fit %\u0026gt;% forecast::forecast(h = 22)\r\rAnalisando a Performance\rComo são muitos modelos, vou separar em dois grupos para colocar no gráfico e ficar mais fácil de visualizar.\n# Plotando os resultados\rg1 \u0026lt;- forecasting %\u0026gt;% filter(.model %in% c(\u0026quot;mean\u0026quot;,\u0026quot;naive\u0026quot;,\u0026quot;snaive\u0026quot;,\u0026quot;drift\u0026quot;)) %\u0026gt;% feasts::autoplot(level = NULL, size = 1)+\rfeasts::autolayer(test_dataset,\rcolor = \u0026quot;black\u0026quot;,\rsize = 1)+\rscale_color_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;none\u0026quot;)\rg2 \u0026lt;-\rforecasting %\u0026gt;% filter(.model %in% c(\u0026quot;mean\u0026quot;,\u0026quot;naive\u0026quot;,\u0026quot;snaive\u0026quot;,\u0026quot;drift\u0026quot;)) %\u0026gt;% feasts::autoplot(train_dataset,\rlevel = NULL, size = 1)+\rfeasts::autolayer(test_dataset,\rcolor = \u0026quot;black\u0026quot;,\rsize = 1)+\rscale_color_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;right\u0026quot;)+\rlabs(x = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rg1/g2 + patchwork::plot_annotation(\rtitle = \u0026quot;Verificando Visualmente a Performance dos Modelos\u0026quot;\r)\rNeste primeiro grupo, evidentemente o modelo ‘Seazonal Naive’ (SNaive) performou melhor. Vamos ver o próximo grupo de modelos.\n# Plotando os resultados\rg1 \u0026lt;- forecasting %\u0026gt;% filter(.model %in% c(\u0026quot;simp_exp_smooth\u0026quot;,\r\u0026quot;holt_linear_trend\u0026quot;,\r\u0026quot;holt_damped_trend\u0026quot;,\r\u0026quot;holt_winter_season_add\u0026quot;,\r\u0026quot;holt_winter_season_mult\u0026quot;)) %\u0026gt;% feasts::autoplot(level = NULL, size = 1)+\rfeasts::autolayer(test_dataset,\rcolor = \u0026quot;black\u0026quot;,\rsize = 1)+\rscale_color_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;none\u0026quot;)\rg2 \u0026lt;-\rforecasting %\u0026gt;% filter(.model %in% c(\u0026quot;simp_exp_smooth\u0026quot;,\r\u0026quot;holt_linear_trend\u0026quot;,\r\u0026quot;holt_damped_trend\u0026quot;,\r\u0026quot;holt_winter_season_add\u0026quot;,\r\u0026quot;holt_winter_season_mult\u0026quot;)) %\u0026gt;% feasts::autoplot(train_dataset,\rlevel = NULL, size = 1)+\rfeasts::autolayer(test_dataset,\rcolor = \u0026quot;black\u0026quot;,\rsize = 1)+\rscale_color_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;right\u0026quot;)+\rlabs(x = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rg1/g2 + patchwork::plot_annotation(\rtitle = \u0026quot;Verificando Visualmente a Performance dos Modelos\u0026quot;\r)\r\r\r","date":1609286400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609286400,"objectID":"648cae831e656eb322d5af022206dbce","permalink":"https://francisco.piccolo.com/post/2020-12-30-forecast-training/","publishdate":"2020-12-30T00:00:00Z","relpermalink":"/post/2020-12-30-forecast-training/","section":"post","summary":"Neste post vou desenvolver e analisar diversos modelos de ‘forecasting’ que aprendi após ler livros sobre o tema. A ideia é mostrar, de maneira simples, como rodar estes modelos no R, como analisar a performance e interpretar os resultados.","tags":null,"title":"Analisando modelos de Forecasting","type":"post"},{"authors":null,"categories":null,"content":"\r\r\rknitr::opts_chunk$set(\rmessage = F,\rwarning = F,\recho = T,\reval = T,\rfig.align = \u0026quot;center\u0026quot;\r)\rApós muitas idas ao mercado, fiquei interessado em saber como os preços dos alimentos oscilam ao longo do tempo e também em como eles se diferenciam de um mercado para outro (especificamente em Jundiaí). Por isso, neste post eu vou analisar um dataset que eu mesmo venho desenvolvendo, que mostra o preço dos alimentos que mais são usados em minha casa.\nCom este script, poderei apenas atualizar o post para pegar a última versão do dataset e acompanhar esta variação de preços. Vamos ver se conseguimos extrair algum insight ao final.\nPara esta tarefa, vou usar os seguintes pacotes:\nlibrary(tidyverse)\rlibrary(patchwork)\r# Função para padronizar o design dos gráficos\rtheme_graph \u0026lt;- function(){\rtheme(\rplot.title = element_text(size = 16),\rplot.subtitle = element_text(size = 12),\rplot.caption = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\raxis.text = element_text(size = 9),\raxis.title = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\rstrip.background = element_rect(fill = \u0026quot;grey\u0026quot;),\rstrip.text = element_text(face = \u0026quot;bold\u0026quot;),\rlegend.position = \u0026quot;bottom\u0026quot;,\rlegend.title = element_blank()\r)\r}\rO dataset está sendo atualizado em meu repositório do github. Se caso quiser acessá-lo pelo R, basta usar o comando abaixo:\ndataset \u0026lt;- readr::read_csv(file = \u0026quot;https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2020-06-20-grocery_price_volatility/dataset_1.csv\u0026quot;)\rPara este estudo, vou preferir olhar apenas para produtos que possuem mais que 3 observações, ou seja, que comprei mais que 4 vezes no período. O código abaixo irá listar os produtos que precisam ser removidos da análise.\ndataset %\u0026gt;%\rgroup_by(product) %\u0026gt;% summarise(rows = n()) %\u0026gt;% filter(rows \u0026lt;= 4) %\u0026gt;% select(product) -\u0026gt; low_sample_product\rCom esta lista de ‘low_sample_product’, podemos ajustar o dataset filtrando estes produtos.\ndataset \u0026lt;- dataset %\u0026gt;% mutate(price_per_vol = price/volume_gm_ml) %\u0026gt;% filter(!product %in% c(low_sample_product$product))\rAnálise Exploratória do Dataset\rVamos entender melhor este dataset antes de focar na volatilidade. Primeiro, vamos ver o período de compra, os mercados e produtos considerados.\ndataset$price \u0026lt;- as.numeric(dataset$price)\rdataset %\u0026gt;% group_by() %\u0026gt;% summarise(first_date = min(date),\rlast_date = max(date)) %\u0026gt;% tibble::tibble()\r## # A tibble: 1 x 2\r## first_date last_date ## \u0026lt;date\u0026gt; \u0026lt;date\u0026gt; ## 1 2020-06-14 2021-02-13\rObservações por Produto e Local de Compra\rdataset %\u0026gt;%\rgroup_by(local,product) %\u0026gt;% summarise(count = n()) %\u0026gt;% ggplot2::ggplot()+\rgeom_col(mapping = aes(x = product, y = count, fill = local))+\rscale_fill_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;none\u0026quot;)+\rcoord_flip()+\rfacet_grid(~local)\r\rVariabilidade\rdataset %\u0026gt;% ggplot2::ggplot()+\rgeom_boxplot(mapping = aes(x = reorder(product,price_per_vol, .fun = mean), y = price_per_vol),\rfill = \u0026quot;steel blue\u0026quot;,\routlier.shape = 20,\routlier.color = \u0026quot;grey\u0026quot;)+\rcoord_flip()+\rtheme_graph()\r\rVariabilidade por Estabelecimento\rdataset %\u0026gt;% ggplot2::ggplot()+\rgeom_boxplot(mapping = aes(x = reorder(product,price_per_vol, .fun = mean), y = price_per_vol, fill = local),\routlier.shape = 20,\routlier.color = \u0026quot;grey\u0026quot;)+\rscale_fill_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rcoord_flip()+\rfacet_grid(~local)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;none\u0026quot;)\r\rSérie Temporal dos Preços por Produto e Estabelecimento\rdataset %\u0026gt;% ggplot2::ggplot()+\rgeom_line(mapping = aes(x = date, y = price_per_vol, group = local, color = local),\rsize = 1)+\rscale_color_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rfacet_wrap(~product)\r\r\r","date":1609286400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609286400,"objectID":"a4aa44dabcc142541f2501b7590b2a5d","permalink":"https://francisco.piccolo.com/draft/food_price_volatility/","publishdate":"2020-12-30T00:00:00Z","relpermalink":"/draft/food_price_volatility/","section":"draft","summary":"knitr::opts_chunk$set(\rmessage = F,\rwarning = F,\recho = T,\reval = T,\rfig.align = \u0026quot;center\u0026quot;\r)\rApós muitas idas ao mercado, fiquei interessado em saber como os preços dos alimentos oscilam ao longo do tempo e também em como eles se diferenciam de um mercado para outro (especificamente em Jundiaí).","tags":null,"title":"Volatilidade no Preços dos Alimentos - Jundiaí","type":"draft"},{"authors":null,"categories":null,"content":"\r\r\rEconometria é uma ferramenta (ou técnica) muito usada por economistas, estatísticos e também por outras ciências. Uma definição encontrada nos livros básicos é:\n\r“Econometria é a aplicação de modelos estatísticos em dados econômicos”\n\rCom base nesta definição, é importante entender a definição de modelos estatísticos e dados econômicos. Em modelos estatísticos, podemos interpretar como equações matemáticas que buscam traduzir um fenômeno estudado, sendo aplicado à coleta, análise e interpretação de dados ou frequência de eventos visando modelar a aleatoriedade e a incerteza. Por outro lado, dados econômicos não possuem uma definição tão clara, porém sabendo que a ciência econômica atua no estudo da alocação dos recursos da sociedade, é possível inferir quando os dados são econômicos.\nEstou apresentando estas definições por conta de que neste post irei focar em um livro de Econometria Básica muito usado nos cursos de Economia. O livro foi escrito por Damodar N. Gujarati e Dawn C. Porter e contêm muitos exercícios usando dados econômicos que achei bastante interessante. Pelo fato de o livro não mostrar as soluções dos problemas, achei válido fazer um post com as soluções de alguns dos exercícios.\nOs dados usados nos exercícios estarão em meu repositório do Github, em formato “.txt”. Para acessar um dataset, basta usar o seguinte comando:\n# Primeiro chame o pacote \u0026#39;readr\u0026#39; que contém a função \u0026#39;read_csv\u0026#39;\rlibrary(readr)\r# Exemplo com o dataset \u0026#39;table_1.3\u0026#39;\rtable_1.3_cpi \u0026lt;- readr::read_delim(file = \u0026quot;https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2020-03-01-basic_econometrics_by_gujarati/table_1.3_cpi.txt\u0026quot;,\rdelim = \u0026quot; \u0026quot;)\rPorém, ao invés de sempre usar este caminho extenso para trazer o dataset, eu posso criar uma variável contendo este caminho e mudar apenas a última parte, em que indico o nome do dataset (i.e. “table_1.3_ipc.txt”).\ndataset_path \u0026lt;- \u0026quot;https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2020-03-01-basic_econometrics_by_gujarati/\u0026quot;\rCom isso, para chamar um dataset, basta usar um comando mais curto, com a função “paste”.\ntable_1.3_cpi \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_1.3_cpi.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;)\rAgora vamos ao que interessa. Para desenvolver os exercícios, vou usar os pacotes abaixo e também uma função para padronizar o design dos gráficos.\nlibrary(tidyverse)\rlibrary(patchwork)\rlibrary(gt)\rlibrary(modelsummary)\rlibrary(stringr)\r# Função para padronizar o design dos gráficos\rtheme_graph \u0026lt;- function(){\rtheme(\rplot.title = element_text(size = 16),\rplot.subtitle = element_text(size = 12),\rplot.caption = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\raxis.text = element_text(size = 9),\raxis.title = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\rstrip.background = element_rect(fill = \u0026quot;grey\u0026quot;),\rstrip.text = element_text(face = \u0026quot;bold\u0026quot;),\rlegend.position = \u0026quot;bottom\u0026quot;,\rlegend.title = element_blank()\r)\r}\rCapítulo 1\r1.1. A Tabela 1.3 apresenta dados relativos ao Índice de Preços ao Consumidor (IPC) de sete países industrializados. A base do índice é 1982–1984 = 100.\ra. Com base nos dados fornecidos, calcule a taxa de inflação de cada país.\nPara resolver este exercício, vamos trazer o dataset necessário.\ntable_1.3_cpi \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_1.3_cpi.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;) %\u0026gt;% mutate(year = as.character(year))\rVamos também ver uma amostra destes dados:\ntable_1.3_cpi %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;.\u0026quot;))\r\r\ryear\rusa\rcanada\rjapan\rfrance\rgermany\ritaly\ruk\r\r\r\r1980\r824\r761\r910\r722\r867\r639\r785\r\r1981\r909\r856\r953\r818\r922\r755\r879\r\r1982\r965\r949\r981\r917\r970\r878\r954\r\r1983\r996\r1.004\r998\r1.003\r1.003\r1.008\r998\r\r1984\r1.039\r1.047\r1.021\r1.080\r1.027\r1.114\r1.048\r\r\r\rA inflação para cada país será a variação de um período com base no período anterior. Para realizar este cálculo, basta usar o ‘mutate’ e a função ‘lag’.\n# Usando o pacote gt (Grammar of Tables) para esse exercício\rtable_1.3_cpi %\u0026gt;% mutate(usa_cpi = usa/lag(usa,1)-1,\rcanada_cpi = canada/lag(canada,1)-1,\rjapan_cpi = japan/lag(japan,1)-1,\rfrance_cpi = france/lag(france,1)-1,\rgermany_cpi = germany/lag(germany,1)-1,\ritaly_cpi = italy/lag(italy,1)-1,\ruk_cpi = uk/lag(uk,1)-1) %\u0026gt;% select(year, usa_cpi, canada_cpi, japan_cpi, france_cpi, germany_cpi, italy_cpi, uk_cpi) %\u0026gt;% tidyr::gather(\u0026quot;country\u0026quot;,\u0026quot;values\u0026quot;, 2:8) %\u0026gt;% filter(!is.na(values)) -\u0026gt; country_cpi\rcountry_cpi %\u0026gt;% tidyr::spread(\u0026quot;country\u0026quot;,\u0026quot;values\u0026quot;) %\u0026gt;% gt::gt() %\u0026gt;% gt::tab_header(title = md(\u0026quot;**Inflação (CPI) para os Países Selecionados**\u0026quot;),\rsubtitle = \u0026quot;De 1981 Até 2005\u0026quot;) %\u0026gt;% gt::tab_source_note(source_note = \u0026quot;Fonte: FMI\u0026quot;) %\u0026gt;% gt::tab_footnote(footnote = \u0026quot;Index = 100\u0026quot;,\rlocations = cells_body(columns = vars(year),\rrows = 4)) %\u0026gt;% fmt_percent(columns = 2:8)\rhtml {\rfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;\r}\r#gwqjcpvree .gt_table {\rdisplay: table;\rborder-collapse: collapse;\rmargin-left: auto;\rmargin-right: auto;\rcolor: #333333;\rfont-size: 16px;\rfont-weight: normal;\rfont-style: normal;\rbackground-color: #FFFFFF;\rwidth: auto;\rborder-top-style: solid;\rborder-top-width: 2px;\rborder-top-color: #A8A8A8;\rborder-right-style: none;\rborder-right-width: 2px;\rborder-right-color: #D3D3D3;\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #A8A8A8;\rborder-left-style: none;\rborder-left-width: 2px;\rborder-left-color: #D3D3D3;\r}\r#gwqjcpvree .gt_heading {\rbackground-color: #FFFFFF;\rtext-align: center;\rborder-bottom-color: #FFFFFF;\rborder-left-style: none;\rborder-left-width: 1px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 1px;\rborder-right-color: #D3D3D3;\r}\r#gwqjcpvree .gt_title {\rcolor: #333333;\rfont-size: 125%;\rfont-weight: initial;\rpadding-top: 4px;\rpadding-bottom: 4px;\rborder-bottom-color: #FFFFFF;\rborder-bottom-width: 0;\r}\r#gwqjcpvree .gt_subtitle {\rcolor: #333333;\rfont-size: 85%;\rfont-weight: initial;\rpadding-top: 0;\rpadding-bottom: 4px;\rborder-top-color: #FFFFFF;\rborder-top-width: 0;\r}\r#gwqjcpvree .gt_bottom_border {\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\r}\r#gwqjcpvree .gt_col_headings {\rborder-top-style: solid;\rborder-top-width: 2px;\rborder-top-color: #D3D3D3;\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\rborder-left-style: none;\rborder-left-width: 1px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 1px;\rborder-right-color: #D3D3D3;\r}\r#gwqjcpvree .gt_col_heading {\rcolor: #333333;\rbackground-color: #FFFFFF;\rfont-size: 100%;\rfont-weight: normal;\rtext-transform: inherit;\rborder-left-style: none;\rborder-left-width: 1px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 1px;\rborder-right-color: #D3D3D3;\rvertical-align: bottom;\rpadding-top: 5px;\rpadding-bottom: 6px;\rpadding-left: 5px;\rpadding-right: 5px;\roverflow-x: hidden;\r}\r#gwqjcpvree .gt_column_spanner_outer {\rcolor: #333333;\rbackground-color: #FFFFFF;\rfont-size: 100%;\rfont-weight: normal;\rtext-transform: inherit;\rpadding-top: 0;\rpadding-bottom: 0;\rpadding-left: 4px;\rpadding-right: 4px;\r}\r#gwqjcpvree .gt_column_spanner_outer:first-child {\rpadding-left: 0;\r}\r#gwqjcpvree .gt_column_spanner_outer:last-child {\rpadding-right: 0;\r}\r#gwqjcpvree .gt_column_spanner {\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\rvertical-align: bottom;\rpadding-top: 5px;\rpadding-bottom: 6px;\roverflow-x: hidden;\rdisplay: inline-block;\rwidth: 100%;\r}\r#gwqjcpvree .gt_group_heading {\rpadding: 8px;\rcolor: #333333;\rbackground-color: #FFFFFF;\rfont-size: 100%;\rfont-weight: initial;\rtext-transform: inherit;\rborder-top-style: solid;\rborder-top-width: 2px;\rborder-top-color: #D3D3D3;\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\rborder-left-style: none;\rborder-left-width: 1px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 1px;\rborder-right-color: #D3D3D3;\rvertical-align: middle;\r}\r#gwqjcpvree .gt_empty_group_heading {\rpadding: 0.5px;\rcolor: #333333;\rbackground-color: #FFFFFF;\rfont-size: 100%;\rfont-weight: initial;\rborder-top-style: solid;\rborder-top-width: 2px;\rborder-top-color: #D3D3D3;\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\rvertical-align: middle;\r}\r#gwqjcpvree .gt_from_md  :first-child {\rmargin-top: 0;\r}\r#gwqjcpvree .gt_from_md  :last-child {\rmargin-bottom: 0;\r}\r#gwqjcpvree .gt_row {\rpadding-top: 8px;\rpadding-bottom: 8px;\rpadding-left: 5px;\rpadding-right: 5px;\rmargin: 10px;\rborder-top-style: solid;\rborder-top-width: 1px;\rborder-top-color: #D3D3D3;\rborder-left-style: none;\rborder-left-width: 1px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 1px;\rborder-right-color: #D3D3D3;\rvertical-align: middle;\roverflow-x: hidden;\r}\r#gwqjcpvree .gt_stub {\rcolor: #333333;\rbackground-color: #FFFFFF;\rfont-size: 100%;\rfont-weight: initial;\rtext-transform: inherit;\rborder-right-style: solid;\rborder-right-width: 2px;\rborder-right-color: #D3D3D3;\rpadding-left: 12px;\r}\r#gwqjcpvree .gt_summary_row {\rcolor: #333333;\rbackground-color: #FFFFFF;\rtext-transform: inherit;\rpadding-top: 8px;\rpadding-bottom: 8px;\rpadding-left: 5px;\rpadding-right: 5px;\r}\r#gwqjcpvree .gt_first_summary_row {\rpadding-top: 8px;\rpadding-bottom: 8px;\rpadding-left: 5px;\rpadding-right: 5px;\rborder-top-style: solid;\rborder-top-width: 2px;\rborder-top-color: #D3D3D3;\r}\r#gwqjcpvree .gt_grand_summary_row {\rcolor: #333333;\rbackground-color: #FFFFFF;\rtext-transform: inherit;\rpadding-top: 8px;\rpadding-bottom: 8px;\rpadding-left: 5px;\rpadding-right: 5px;\r}\r#gwqjcpvree .gt_first_grand_summary_row {\rpadding-top: 8px;\rpadding-bottom: 8px;\rpadding-left: 5px;\rpadding-right: 5px;\rborder-top-style: double;\rborder-top-width: 6px;\rborder-top-color: #D3D3D3;\r}\r#gwqjcpvree .gt_striped {\rbackground-color: rgba(128, 128, 128, 0.05);\r}\r#gwqjcpvree .gt_table_body {\rborder-top-style: solid;\rborder-top-width: 2px;\rborder-top-color: #D3D3D3;\rborder-bottom-style: solid;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\r}\r#gwqjcpvree .gt_footnotes {\rcolor: #333333;\rbackground-color: #FFFFFF;\rborder-bottom-style: none;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\rborder-left-style: none;\rborder-left-width: 2px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 2px;\rborder-right-color: #D3D3D3;\r}\r#gwqjcpvree .gt_footnote {\rmargin: 0px;\rfont-size: 90%;\rpadding: 4px;\r}\r#gwqjcpvree .gt_sourcenotes {\rcolor: #333333;\rbackground-color: #FFFFFF;\rborder-bottom-style: none;\rborder-bottom-width: 2px;\rborder-bottom-color: #D3D3D3;\rborder-left-style: none;\rborder-left-width: 2px;\rborder-left-color: #D3D3D3;\rborder-right-style: none;\rborder-right-width: 2px;\rborder-right-color: #D3D3D3;\r}\r#gwqjcpvree .gt_sourcenote {\rfont-size: 90%;\rpadding: 4px;\r}\r#gwqjcpvree .gt_left {\rtext-align: left;\r}\r#gwqjcpvree .gt_center {\rtext-align: center;\r}\r#gwqjcpvree .gt_right {\rtext-align: right;\rfont-variant-numeric: tabular-nums;\r}\r#gwqjcpvree .gt_font_normal {\rfont-weight: normal;\r}\r#gwqjcpvree .gt_font_bold {\rfont-weight: bold;\r}\r#gwqjcpvree .gt_font_italic {\rfont-style: italic;\r}\r#gwqjcpvree .gt_super {\rfont-size: 65%;\r}\r#gwqjcpvree .gt_footnote_marks {\rfont-style: italic;\rfont-size: 65%;\r}\r\r\rInflação (CPI) para os Países Selecionados\r\r\rDe 1981 Até 2005\r\r\r\ryear\rcanada_cpi\rfrance_cpi\rgermany_cpi\ritaly_cpi\rjapan_cpi\ruk_cpi\rusa_cpi\r\r\r\r1981\r12.48\u0026percnt;\r13.30\u0026percnt;\r6.34\u0026percnt;\r18.15\u0026percnt;\r4.73\u0026percnt;\r11.97\u0026percnt;\r10.32\u0026percnt;\r\r\r1982\r10.86\u0026percnt;\r12.10\u0026percnt;\r5.21\u0026percnt;\r16.29\u0026percnt;\r2.94\u0026percnt;\r8.53\u0026percnt;\r6.16\u0026percnt;\r\r\r1983\r5.80\u0026percnt;\r9.38\u0026percnt;\r3.40\u0026percnt;\r14.81\u0026percnt;\r1.73\u0026percnt;\r4.61\u0026percnt;\r3.21\u0026percnt;\r\r\r19841\r4.28\u0026percnt;\r7.68\u0026percnt;\r2.39\u0026percnt;\r10.52\u0026percnt;\r2.30\u0026percnt;\r5.01\u0026percnt;\r4.32\u0026percnt;\r\r\r1985\r4.11\u0026percnt;\r5.83\u0026percnt;\r2.04\u0026percnt;\r9.25\u0026percnt;\r2.06\u0026percnt;\r6.01\u0026percnt;\r3.56\u0026percnt;\r\r\r1986\r4.13\u0026percnt;\r2.54\u0026percnt;\r\u0026minus;0.19\u0026percnt;\r5.92\u0026percnt;\r0.67\u0026percnt;\r3.42\u0026percnt;\r1.86\u0026percnt;\r\r\r1987\r4.32\u0026percnt;\r3.33\u0026percnt;\r0.29\u0026percnt;\r4.81\u0026percnt;\r0.00\u0026percnt;\r4.18\u0026percnt;\r3.65\u0026percnt;\r\r\r1988\r4.05\u0026percnt;\r2.64\u0026percnt;\r1.33\u0026percnt;\r5.03\u0026percnt;\r0.67\u0026percnt;\r4.93\u0026percnt;\r4.14\u0026percnt;\r\r\r1989\r4.95\u0026percnt;\r3.54\u0026percnt;\r2.73\u0026percnt;\r6.20\u0026percnt;\r2.27\u0026percnt;\r7.80\u0026percnt;\r4.82\u0026percnt;\r\r\r1990\r4.80\u0026percnt;\r3.26\u0026percnt;\r2.75\u0026percnt;\r6.44\u0026percnt;\r3.15\u0026percnt;\r9.45\u0026percnt;\r5.40\u0026percnt;\r\r\r1991\r5.61\u0026percnt;\r3.24\u0026percnt;\r3.65\u0026percnt;\r6.30\u0026percnt;\r3.23\u0026percnt;\r5.87\u0026percnt;\r4.21\u0026percnt;\r\r\r1992\r1.54\u0026percnt;\r2.33\u0026percnt;\r5.07\u0026percnt;\r5.28\u0026percnt;\r1.74\u0026percnt;\r3.70\u0026percnt;\r3.01\u0026percnt;\r\r\r1993\r1.79\u0026percnt;\r2.14\u0026percnt;\r4.42\u0026percnt;\r4.57\u0026percnt;\r1.28\u0026percnt;\r1.60\u0026percnt;\r2.99\u0026percnt;\r\r\r1994\r0.20\u0026percnt;\r1.67\u0026percnt;\r2.74\u0026percnt;\r4.05\u0026percnt;\r0.68\u0026percnt;\r2.42\u0026percnt;\r2.56\u0026percnt;\r\r\r1995\r2.16\u0026percnt;\r1.78\u0026percnt;\r1.68\u0026percnt;\r5.27\u0026percnt;\r\u0026minus;0.08\u0026percnt;\r3.48\u0026percnt;\r2.83\u0026percnt;\r\r\r1996\r1.59\u0026percnt;\r2.02\u0026percnt;\r1.50\u0026percnt;\r3.99\u0026percnt;\r0.08\u0026percnt;\r2.40\u0026percnt;\r2.95\u0026percnt;\r\r\r1997\r1.63\u0026percnt;\r1.19\u0026percnt;\r1.85\u0026percnt;\r2.06\u0026percnt;\r1.84\u0026percnt;\r3.18\u0026percnt;\r2.29\u0026percnt;\r\r\r1998\r0.96\u0026percnt;\r0.65\u0026percnt;\r0.94\u0026percnt;\r1.97\u0026percnt;\r0.58\u0026percnt;\r3.40\u0026percnt;\r1.56\u0026percnt;\r\r\r1999\r1.71\u0026percnt;\r0.52\u0026percnt;\r0.65\u0026percnt;\r1.66\u0026percnt;\r\u0026minus;0.33\u0026percnt;\r1.52\u0026percnt;\r2.21\u0026percnt;\r\r\r2000\r2.74\u0026percnt;\r1.68\u0026percnt;\r1.43\u0026percnt;\r2.52\u0026percnt;\r\u0026minus;0.66\u0026percnt;\r2.99\u0026percnt;\r3.36\u0026percnt;\r\r\r2001\r2.55\u0026percnt;\r1.65\u0026percnt;\r1.97\u0026percnt;\r2.76\u0026percnt;\r\u0026minus;0.74\u0026percnt;\r1.75\u0026percnt;\r2.85\u0026percnt;\r\r\r2002\r2.25\u0026percnt;\r1.94\u0026percnt;\r1.31\u0026percnt;\r2.52\u0026percnt;\r\u0026minus;0.92\u0026percnt;\r1.67\u0026percnt;\r1.58\u0026percnt;\r\r\r2003\r2.78\u0026percnt;\r2.08\u0026percnt;\r1.09\u0026percnt;\r2.66\u0026percnt;\r\u0026minus;0.25\u0026percnt;\r2.90\u0026percnt;\r2.28\u0026percnt;\r\r\r2004\r1.86\u0026percnt;\r2.16\u0026percnt;\r1.69\u0026percnt;\r2.19\u0026percnt;\r0.00\u0026percnt;\r3.00\u0026percnt;\r2.66\u0026percnt;\r\r\r2005\r2.15\u0026percnt;\r1.70\u0026percnt;\r1.92\u0026percnt;\r1.95\u0026percnt;\r\u0026minus;0.34\u0026percnt;\r2.83\u0026percnt;\r3.39\u0026percnt;\r\r\r\rFonte: FMI\r\r\r\r1\r\rIndex = 100\r\r\r\r\rb. Represente graficamente a taxa de inflação de cada país em relação ao tempo (isto é, use o eixo horizontal para o tempo e o eixo vertical para a taxa de inflação).\ncountry_cpi %\u0026gt;% ggplot2::ggplot()+\rgeom_line(mapping = aes(x = year, y = values, group = country, color = country))+\rscale_y_continuous(labels = scales::percent)+\rscale_x_discrete(breaks = c(\u0026quot;1985\u0026quot;,\u0026quot;1995\u0026quot;,\u0026quot;2005\u0026quot;))+\rscale_color_brewer(type = \u0026quot;qual\u0026quot;, palette = 2)+\rtheme_graph()+\rlabs(title = \u0026quot;Inflação dos Países Selecionados\u0026quot;,\ry = \u0026quot;CPI (Consumer Price Index)\u0026quot;)\rc. Que conclusões gerais é possível tirar sobre a evolução da inflação nos sete países?\nHá uma tendência de queda nos países selecionados após 1985, onde todos mantiveram uma taxa abaio de 5% ao ano.\nd. Em que país a taxa de inflação parece ser a mais flutuante? Há alguma explicação para isso?\nA tabela abaixo mostra um resumo da inflação de cada país, já transformada em percentual.\ncountry_cpi %\u0026gt;% mutate(values = values*100) %\u0026gt;% tidyr::spread(\u0026quot;country\u0026quot;,\u0026quot;values\u0026quot;) %\u0026gt;% modelsummary::datasummary_skim()\r\r\r\rUnique (#)\r\rMissing (%)\r\rMean\r\rSD\r\rMin\r\rMedian\r\rMax\r\r\r\r\r\r\rcanada_cpi\r\r25\r\r0\r\r3.7\r\r2.8\r\r0.2\r\r2.7\r\r12.5\r\r\r\r\r\r\rfrance_cpi\r\r25\r\r0\r\r3.6\r\r3.4\r\r0.5\r\r2.2\r\r13.3\r\r\r\r\r\r\rgermany_cpi\r\r25\r\r0\r\r2.3\r\r1.6\r\r-0.2\r\r1.9\r\r6.3\r\r\r\r\r\r\ritaly_cpi\r\r25\r\r0\r\r5.9\r\r4.6\r\r1.7\r\r4.8\r\r18.2\r\r\r\r\r\r\rjapan_cpi\r\r24\r\r0\r\r1.1\r\r1.5\r\r-0.9\r\r0.7\r\r4.7\r\r\r\r\r\r\ruk_cpi\r\r25\r\r0\r\r4.3\r\r2.7\r\r1.5\r\r3.4\r\r12.0\r\r\r\r\r\r\rusa_cpi\r\r25\r\r0\r\r3.5\r\r1.8\r\r1.6\r\r3.0\r\r10.3\r\r\r\r\r\r\r\rO desvio padrão (SD) mais elevado é o da Itália, talvez por ter um outlier no valor máximo (de 18.2%). O gráfico abaixo irá dar destaque para este país para vermos se é evidente que sua flutuação é maior que a dos outros.\ncountry_cpi %\u0026gt;% mutate(is_floating = as.character(case_when(country == \u0026quot;italy_cpi\u0026quot; ~ \u0026quot;Italy CPI\u0026quot;,\rTRUE ~ \u0026quot;Others\u0026quot;))) %\u0026gt;% ggplot2::ggplot()+\rgeom_line(mapping = aes(x = year, y = values, group = country, color = is_floating),\rsize = 1)+\rscale_y_continuous(labels = scales::percent)+\rscale_x_discrete(breaks = c(\u0026quot;1985\u0026quot;,\u0026quot;1995\u0026quot;,\u0026quot;2005\u0026quot;))+\rscale_color_manual(values = c(\u0026quot;Italy CPI\u0026quot; = \u0026quot;dark orange\u0026quot;,\r\u0026quot;Others\u0026quot; = \u0026quot;steel blue\u0026quot;),\rname = \u0026quot;Inflação da Inglaterra = 1\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Análise da Inflação na Itália\u0026quot;,\rsubtitle = \u0026quot;Aparentemente é a taxa mais flutuante\u0026quot;,\ry = \u0026quot;CPI (Consumer Price Index)\u0026quot;)\rA flutuação parece maior na Itália por conta dos primeiros anos, onde a inflação ficou bastante alta. Caso a análise seja feita a partir de 1985, a Inglaterra fica com maior desvio padrão.\n\r1.2\ra. Usando a Tabela 1.3, represente as taxas de inflação do Canadá, França, Alemanha, Itália, Japão e Reino Unido em relação à taxa de inflação dos Estados Unidos.\nCom o pacote GGally é possível criar estes comparativos mais facilmente.\ncountry_cpi %\u0026gt;% tidyr::spread(\u0026quot;country\u0026quot;, \u0026quot;values\u0026quot;) %\u0026gt;% GGally::ggpairs(columns = 2:8)+\rtheme_graph()+\rtheme(axis.text = element_blank())+\rlabs(title = \u0026quot;Correlação Entre as Taxas de Inflação\u0026quot;)\rApenas a linha e coluna ‘usa_cpi’ precisa ser usada, mostrando o gráficos de dispersão entre as variáveis e seu coeficiente de correlação. A menor correlação é a da Alemanha, que ficou em 69,3%.\nb. Faça um comentário geral sobre o comportamento das taxas de inflação dos seis países em relação à inflação dos Estados Unidos.\ncountry_cpi %\u0026gt;% tidyr::spread(\u0026quot;country\u0026quot;, \u0026quot;values\u0026quot;) %\u0026gt;% select(-year) %\u0026gt;% cor() %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\r\rcanada_cpi\r\rfrance_cpi\r\rgermany_cpi\r\ritaly_cpi\r\rjapan_cpi\r\ruk_cpi\r\rusa_cpi\r\r\r\r\r\rcanada_cpi\r\r1,0000000\r\r0,9031983\r\r0,5858029\r\r0,8816498\r\r0,7205414\r\r0,8544959\r\r0,8730004\r\r\r\rfrance_cpi\r\r0,9031983\r\r1,0000000\r\r0,6567352\r\r0,9770683\r\r0,7057817\r\r0,7465621\r\r0,7863659\r\r\r\rgermany_cpi\r\r0,5858029\r\r0,6567352\r\r1,0000000\r\r0,6749995\r\r0,7360533\r\r0,5766805\r\r0,6926212\r\r\r\ritaly_cpi\r\r0,8816498\r\r0,9770683\r\r0,6749995\r\r1,0000000\r\r0,7540024\r\r0,7600933\r\r0,7644961\r\r\r\rjapan_cpi\r\r0,7205414\r\r0,7057817\r\r0,7360533\r\r0,7540024\r\r1,0000000\r\r0,8570803\r\r0,7634052\r\r\r\ruk_cpi\r\r0,8544959\r\r0,7465621\r\r0,5766805\r\r0,7600933\r\r0,8570803\r\r1,0000000\r\r0,8940935\r\r\r\rusa_cpi\r\r0,8730004\r\r0,7863659\r\r0,6926212\r\r0,7644961\r\r0,7634052\r\r0,8940935\r\r1,0000000\r\r\r\r\rOs países selecionados possuem economias já desenvolvidas e bastante conectadas entre si, por isso há este comportamento parecido nas taxas de inflação. A correlação é alta não apenas entre os EUA e os outros países, por conta desta conexão entre as economias.\nc. Se você constatar que as taxas de inflação dos seis países evoluem no mesmo sentido que a dos Estados Unidos, isso sugere que a inflação dos Estados Unidos “causa” inflação nos outros países? Justifique.\nCom estes dados não é possível verificar se há uma correlação espúria entre as variáveis, portanto não consigo afirmar se a variação na inflação dos EUA causa variação na inflação dos outros países. Mas pelo que lembro das aulas de macroeconomia, se um país está tendo inflação, sua moeda tende a se desvalorizar frente à outras moedas e se um país importa de outro que está tendo uma desvalorização cambial, ocorrerá uma queda no custo de importação e consequentemente uma pressão para redução de preços.\r### 1.3 A Tabela 1.4 apresenta as taxas de câmbio em sete países industrializados, no período 1985 - 2006. Exceto no caso do Reino Unido, as taxas de câmbio estão definidas como unidades de moeda estrangeira por um dólar; no caso do Reino Unido, a taxa de câmbio é dada como o número de dólares por uma libra esterlina.\na. Represente graficamente a evolução das taxas de câmbio ao longo do tempo e comente sobre o comportamento geral dessa evolução.\n# Trazendo o dataset para o exercício\rtable_1.4_exchange_rate \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_1.4_exchange_rate.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot;\\t\u0026quot;)\rtable_1.4_exchange_rate %\u0026gt;% mutate(Ano = as.character(Ano)) %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\rAno\r\rAustralia\r\rCanada\r\rChina\r\rJapao\r\rMexico\r\rCoreia.sul\r\rSuecia\r\rSuica\r\rReino.unido\r\r\r\r\r\r1985\r\r0,7003\r\r1,3659\r\r2,9434\r\r238.4700\r\r0,257\r\r872,45\r\r8,6032\r\r2,4552\r\r1,2974\r\r\r\r1986\r\r0,6709\r\r1,3896\r\r3,4616\r\r168.3500\r\r0,612\r\r884,60\r\r7,1273\r\r1,7979\r\r1,4677\r\r\r\r1987\r\r0,7014\r\r1,3259\r\r3,7314\r\r144.6000\r\r1,378\r\r826,16\r\r6,3469\r\r1,4918\r\r1,6398\r\r\r\r1988\r\r0,7841\r\r1,2306\r\r3,7314\r\r128.1700\r\r2,273\r\r734,52\r\r6,1370\r\r1,4643\r\r1,7813\r\r\r\r1989\r\r0,7919\r\r1,1842\r\r3,7673\r\r138.0700\r\r2,461\r\r674,13\r\r6,4559\r\r1,6369\r\r1,6382\r\r\r\r\rAntes de plotar o gráfico, vou fazer um ajuste para o Reino Unido para representar a mesma unidade de medida que os outros países (unidades de moeda local para adquirir 1 dólar).\ntable_1.4_exchange_rate %\u0026gt;% mutate(Reino.unido = 1/Reino.unido) %\u0026gt;% # Ajustando o Reino Unido\rtidyr::gather(\u0026quot;country\u0026quot;, \u0026quot;values\u0026quot;, 2:10) %\u0026gt;% mutate(values = as.numeric(values)) %\u0026gt;% ggplot2::ggplot()+\rgeom_col(mapping = aes(x = Ano, y = values, fill = country), alpha = .6)+\rscale_y_continuous(labels = scales::comma)+\rscale_fill_brewer(type = \u0026quot;qual\u0026quot;, palette = 3)+\rtheme_graph()+\rtheme(legend.position = \u0026quot;none\u0026quot;)+\rfacet_wrap(~country, scales = \u0026quot;free_y\u0026quot;)+\rlabs(title = \u0026quot;Taxa de Câmbio de Países Selecionados\u0026quot;,\rsubtitle = \u0026quot;Unidade de moeda local por 1 dólar\u0026quot;,\ry = \u0026quot;Taxa de Câmbio\u0026quot;,\rx = \u0026quot;\u0026quot;)\rDe maneira geral, apenas o México mostrou uma tendência de desvalorização de sua taxa de câmbio. Os outros países parecem ter a taxa de câmbio sob controle.\nb. Diz-se que o dólar apreciou-se quando pode comprar mais unidades de moeda estrangeira. Opostamente, diz-se que se depreciou quando compra menos unidades da moeda estrangeira. No período 1985–2006, qual foi o comportamento geral do dólar dos Estados Unidos? Aproveite para pesquisar em algum livro de macroeconomia ou de economia internacional os fatores que determinam a apreciação ou depreciação de uma moeda.\nO comportamento foi variado entre os países selecionados. Em alguns (Suíça, Japão e Reino Unido) houve desvalorização do dólar e em outros (México, China e Coréia do Sul), houve valorização.\n\r1.4 A Tabela 1.5 apresenta os dados relativos à oferta monetária, no conceito de M1, que aparecem na Figura 1.5. Você poderia apresentar razões para o aumento da oferta de moeda no período considerado?\rtable_1.5_currency_m1_volume \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_1.5_currency_m1_volume.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot;\\t\u0026quot;)\r# Amostra do dataset\rtable_1.5_currency_m1_volume %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\rperiod\r\rmonth_1\r\rmonth_2\r\rmonth_3\r\rmonth_4\r\rmonth_5\r\rmonth_6\r\r\r\r\r\r1959:01\r\r138,9\r\r139,4\r\r139,7\r\r139,7\r\r140,7\r\r141,2\r\r\r\r1959:07\r\r141,7\r\r141,9\r\r141,0\r\r140,5\r\r140,4\r\r140,0\r\r\r\r1960:01\r\r140,0\r\r139,9\r\r139,8\r\r139,6\r\r139,6\r\r139,6\r\r\r\r1960:07\r\r140,2\r\r141,3\r\r141,2\r\r140,9\r\r140,9\r\r140,7\r\r\r\r1961:01\r\r141,1\r\r141,6\r\r141,9\r\r142,1\r\r142,7\r\r142,9\r\r\r\r\rEsta tabela precisa ser tratada para poder ser analisada de maneira fácil. Veja que há 6 colunas para 6 meses de dados e os anos contemplam duas linhas. Será necessário ajustar para que cada mês fique em uma linha e o dataset tenha os campos ‘ano’, ‘mês’ e ‘valor (m1)’.\ntable_1.5_currency_m1_volume %\u0026gt;% tidyr::gather(\u0026quot;month\u0026quot;, \u0026quot;value\u0026quot;, 2:7) %\u0026gt;% filter(!is.na(value)) %\u0026gt;% mutate(semester = as.numeric(stringr::str_sub(string = period, start = 6, end = 7)),\ryear = stringr::str_sub(string = period, start = 0, end = 4),\rmonth = as.numeric(stringr::str_sub(string = month, start = 7, end = 7))-1+semester) %\u0026gt;% select(year, month, value) %\u0026gt;% mutate(year_and_month = paste(year, month, sep = \u0026quot;/\u0026quot;)) -\u0026gt; table_1.5_adj\rtable_1.5_adj %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\ryear\r\rmonth\r\rvalue\r\ryear_and_month\r\r\r\r\r\r1959\r\r1\r\r138,9\r\r1959/1\r\r\r\r1959\r\r7\r\r141,7\r\r1959/7\r\r\r\r1960\r\r1\r\r140,0\r\r1960/1\r\r\r\r1960\r\r7\r\r140,2\r\r1960/7\r\r\r\r1961\r\r1\r\r141,1\r\r1961/1\r\r\r\r\rAgora podemos plotar o gráfico conforme solicitado e tentar analisar o aumento no período considerado.\ntable_1.5_adj %\u0026gt;% ggplot2::ggplot()+\rgeom_line(mapping = aes(x = year_and_month, y = value, group = 1))+\rscale_y_continuous(labels = scales::comma)+\rscale_x_discrete(breaks = c(\u0026quot;1960/5\u0026quot;,\u0026quot;1970/5\u0026quot;,\u0026quot;1980/5\u0026quot;,\u0026quot;1990/5\u0026quot;,\u0026quot;1999/1\u0026quot;))+\rtheme_graph()+\rlabs(title = \u0026quot;Oferta Monetária\u0026quot;,\rsubtitle = \u0026quot;M1: Moeda em poder do público + Reservas Bancárias\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;M1\u0026quot;)\rO crescimento pode ser atribuído ao aumento de oferta de crédito pelo governo e também ao crescimento econômico, que faz as pessoas sacarem seus investimentos para consumo ou investimento.\n\r1.7 Os dados apresentados na Tabela 1.6 foram divulgados na edição do The Wall Street Journal de 1º de março de 1984. Relacionam o orçamento de publicidade (em milhões de dólares) de 21 empresas em 1983 com as impressões retidas, semanalmente, pelos que viram os produtos anunciados por essas empresas. Os dados foram obtidos em uma pesquisa realizada com 4 mil adultos, em que foi pedido aos usuários dos produtos que citassem um comercial da categoria do produto que tivessem assistido na semana anterior.\rVamos importar o dataset do Github e ver uma amostra dos valores.\n# Este arquivo está separado por \u0026#39;;\u0026#39; ao invés de \u0026#39;\\tab\u0026#39;\rtable_1.6_advertising \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_1.6_advertising.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot;\\t\u0026quot;) %\u0026gt;% mutate(impressions = as.numeric(impressions),\rinvestment = as.numeric(investment))\r# Amostra do dataset\rtable_1.6_advertising %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\rimpressions\r\rinvestment\r\rcompany\r\r\r\r\r\r32,1\r\r50,1\r\rMiller_Lite\r\r\r\r99,6\r\r74,1\r\rPepsi\r\r\r\r11,7\r\r19,3\r\rStroh\r\r\r\r21,9\r\r22,9\r\rFed_Express\r\r\r\r60,8\r\r82,4\r\rBurger_King\r\r\r\r\ra. Trace um gráfico com as impressões no eixo vertical e os gastos com publicidade no eixo horizontal.\ntable_1.6_advertising %\u0026gt;% ggplot2::ggplot()+\rgeom_point(mapping = aes(x = investment, y = impressions), shape = 2,\rcolor = \u0026quot;steel blue\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Impressões vs Investimento em Publicidade\u0026quot;,\rsubtitle = \u0026quot;Impressões Retidas nos Proutos Anunciados\u0026quot;,\rx = \u0026quot;Investimento em Publicidade (milhões de US$)\u0026quot;,\ry = \u0026quot;Impressões Retidas em Produtos Anunciados\u0026quot;)\rb. O que você poderia dizer sobre a natureza da relação entre as duas variáveis?\nApesar de existir uma correlação (notada pelo gráfico, não estatísticamente comprovada), ela pode não ser linear.\nc. Examinando o gráfico, você acha que vale a pena anunciar? Pense em todos os comerciais veiculados em finais de campeonatos de esportes ou no horário nobre.\nParece valer a pena anunciar, porém não uma quantia acima de 100 milhões de dólares.\n\r\rCapítulo 2\r2.14. Com os dados da Tabela 2.7 relativos aos Estados Unidos nos período 1980-2006:\ra. Represente graficamente a relação entre a taxa de participação dos homens na força de trabalho civil e a taxa de desemprego civil dos homens. Trace, a olho, uma linha de regressão que passe pelos pontos. A priori, qual a relação esperada entre as duas variáveis e em que teoria econômica está embasada? O diagrama de dispersão respalda essa teoria?\ntable_2.7_labour_market \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_2.7_labour_market.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;)\r# Amostra do dataset\rtable_2.7_labour_market %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\ryear\r\rshare_men_work_force\r\rshare_women_work_force\r\runemployment_men\r\runemployment_women\r\ravg_hourly_earning_men\r\ravg_hourly_earning_women\r\r\r\r\r\r1.980\r\r77,4\r\r51,5\r\r6,9\r\r7,4\r\r7,99\r\r6,84\r\r\r\r1.981\r\r77,0\r\r52,1\r\r7,4\r\r7,9\r\r7,88\r\r7,43\r\r\r\r1.982\r\r76,6\r\r52,6\r\r9,9\r\r9,4\r\r7,86\r\r7,86\r\r\r\r1.983\r\r76,4\r\r52,9\r\r9,9\r\r9,2\r\r7,95\r\r8,19\r\r\r\r1.984\r\r76,4\r\r53,6\r\r7,4\r\r7,6\r\r7,95\r\r8,48\r\r\r\r\rO dataset está em um formato não muito organizado (‘tidy’), pois está com as variáveis duplicadas para representar homens e mulheres. Vou ajustar o dataset para agrupar as variáveis e separar as linhas em ‘men’/‘women’.\ntable_2.7_labour_market %\u0026gt;% select(year,\rshare_men_work_force,\rshare_women_work_force) %\u0026gt;% tidyr::gather(\u0026quot;gender\u0026quot;,\u0026quot;values\u0026quot;,2:3) %\u0026gt;% inner_join(table_2.7_labour_market %\u0026gt;% select(year,\runemployment_men,\runemployment_women) %\u0026gt;%\rtidyr::gather(\u0026quot;gender\u0026quot;,\u0026quot;values\u0026quot;,2:3),\rby = c(\u0026quot;year\u0026quot; = \u0026quot;year\u0026quot;)) %\u0026gt;% inner_join(table_2.7_labour_market %\u0026gt;% select(year,\ravg_hourly_earning_men,\ravg_hourly_earning_women) %\u0026gt;%\rtidyr::gather(\u0026quot;gender\u0026quot;,\u0026quot;values\u0026quot;,2:3),\rby = c(\u0026quot;year\u0026quot; = \u0026quot;year\u0026quot;)) %\u0026gt;% mutate(gender.x = ifelse(gender.x == \u0026quot;share_men_work_force\u0026quot;,\u0026quot;men\u0026quot;,\u0026quot;women\u0026quot;)) %\u0026gt;% mutate(gender = gender.x,\rshare_work_force = values.x,\runemployment_rate = values.y,\rhourly_wage = values) %\u0026gt;% select(year,\rgender,\rshare_work_force,\runemployment_rate,\rhourly_wage) -\u0026gt; table_2.7_labour_market_adj\rVeja a tabela ajustada. Talvez desse para fazer o ajuste com menos código, mas no fim o resultado deu certo.\ntable_2.7_labour_market_adj %\u0026gt;% head(5) %\u0026gt;% knitr::kable()\r\r\r\ryear\r\rgender\r\rshare_work_force\r\runemployment_rate\r\rhourly_wage\r\r\r\r\r\r1980\r\rmen\r\r77.4\r\r6.9\r\r7.99\r\r\r\r1980\r\rmen\r\r77.4\r\r6.9\r\r6.84\r\r\r\r1980\r\rmen\r\r77.4\r\r7.4\r\r7.99\r\r\r\r1980\r\rmen\r\r77.4\r\r7.4\r\r6.84\r\r\r\r1981\r\rmen\r\r77.0\r\r7.4\r\r7.88\r\r\r\r\rtable_2.7_labour_market_adj %\u0026gt;% filter(gender == \u0026quot;men\u0026quot;) %\u0026gt;% ggplot2::ggplot()+\rgeom_point(mapping = aes(x = share_work_force, y = unemployment_rate))+\rtheme_graph()+\rlabs(title = \u0026quot;Relação entre Participação na Força de Trabalho e Taxa de Desemprego\u0026quot;,\rsubtitle = \u0026quot;Para os Homens\u0026quot;,\rx = \u0026quot;Participação (%) no mercado de trabalho\u0026quot;,\ry = \u0026quot;Taxa (%) de Desemprego\u0026quot;)\rb. Faça o mesmo para as mulheres\ntable_2.7_labour_market_adj %\u0026gt;%\rfilter(gender == \u0026quot;women\u0026quot;) %\u0026gt;% ggplot2::ggplot()+\rgeom_point(mapping = aes(x = share_work_force, y = unemployment_rate))+\rtheme_graph()+\rlabs(title = \u0026quot;Relação entre Participação na Força de Trabalho e Taxa de Desemprego\u0026quot;,\rsubtitle = \u0026quot;Para as Mulheres\u0026quot;,\rx = \u0026quot;Participação (%) no mercado de trabalho\u0026quot;,\ry = \u0026quot;Taxa (%) de Desemprego\u0026quot;)\rc. Agora, represente graficamente a taxa de participação de homens e mulheres em relação aos ganhos médios por hora (em dólares de 1982). (Você pode usar gráficos separados.) O que constatou? Como você justificaria isso?\ntable_2.7_labour_market_adj %\u0026gt;% ggplot2::ggplot()+\rgeom_point(mapping = aes(x = share_work_force, y = hourly_wage, color = gender))+\rtheme_graph()+\rscale_color_viridis_d()+\rfacet_grid(~gender, scales = \u0026quot;free\u0026quot;)+\rlabs(title = \u0026quot;Relação Entre Salário e Participação no Mercado de Trabalho\u0026quot;,\rx = \u0026quot;Participação no Mercado de Trabalho (%)\u0026quot;,\ry = \u0026quot;Salário por Hora\u0026quot;)\r\r2.15. A Tabela 2.8 apresenta dados sobre despesas com alimentação e gastos totais, em rupias, para uma amostra de 55 domicílios rurais da Índia. (No início de 2000, um dólar americano era equivalente a cerca de 40 rupias indianas.)\rtable_2.8_expenses_in_india \u0026lt;- readr::read_delim(file = paste(dataset_path,\r\u0026quot;table_2.8_expenses_in_india.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;)\rtable_2.8_expenses_in_india %\u0026gt;% head(5) %\u0026gt;% kableExtra::kable()\r\r\r\rfood\r\rtotal\r\r\r\r\r\r217\r\r382\r\r\r\r196\r\r388\r\r\r\r303\r\r391\r\r\r\r270\r\r415\r\r\r\r325\r\r456\r\r\r\r\ra. Represente graficamente os dados colocando no eixo vertical as despesas com alimentação e no eixo horizontal os gastos totais. Trace uma linha de regressão.\ntable_2.8_expenses_in_india %\u0026gt;%\rggplot2::ggplot()+\rgeom_point(mapping = aes(x = total, y = food), shape = 2,\rcolor = \u0026quot;dark orange\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Despesas Totais vs Despesas com Alimentação\u0026quot;,\rx = \u0026quot;Despesas Totais\u0026quot;,\ry = \u0026quot;Despesas com Alimentação\u0026quot;)\rb. Que conclusões gerais você pode tirar deste exemplo?\nA correlação é mais para famílias de baixa renda (com despesas totais abaixo de 600 rupias), visto que a maior parte dos gastos se concentra em itens básicos de alimentação. Porém, no geral, pode-se concluir com base neste teste visual, que há uma correlação entre as duas variáveis.\nc. Você esperaria, a priori, que as despesas com alimentação aumentassem linearmente com o aumento das despesas totais, independentemente do nível destas? Por quê? Utilize a despesa total como uma proxy para o nível de renda total.\nNão esperaria, visto que com o aumento do nível de renda a necessidade de se comprar mais alimentos não aumentará na mesma magnitude.\n\r2.16. A Tabela 2.9 apresenta dados sobre a pontuação média do Teste de Aptidão Escolar (SAT) para os estudantes que se preparavam para ingressar no ensino superior no período 1967-1990.\rtable_2.9_sat_scores \u0026lt;-\rreadr::read_delim(file = paste(dataset_path,\r\u0026quot;table_2.9_sat_scores.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;)\rtable_2.9_sat_scores %\u0026gt;% head(5) %\u0026gt;% kableExtra::kable()\r\r\r\ryear\r\rmen_verbal_score\r\rwonem_verbal_score\r\rverbal_score_total\r\rmen_math_score\r\rwomen_math_score\r\rmath_score_total\r\r\r\r\r\r1972\r\r531\r\r529\r\r530\r\r527\r\r489\r\r509\r\r\r\r1973\r\r523\r\r521\r\r523\r\r525\r\r489\r\r506\r\r\r\r1974\r\r524\r\r520\r\r521\r\r524\r\r488\r\r505\r\r\r\r1975\r\r515\r\r509\r\r512\r\r518\r\r479\r\r498\r\r\r\r1976\r\r511\r\r508\r\r509\r\r520\r\r475\r\r497\r\r\r\r\ra. Use o eixo horizontal para os anos e o eixo vertical para a pontuação obtida para traçar as notas nas provas de aptidão verbal e matemática obtidas por homens e mulheres, separadamente.\nverbal_graph \u0026lt;- table_2.9_sat_scores %\u0026gt;% ggplot2::ggplot(mapping = aes(x = year))+\rgeom_line(mapping = aes(y = men_verbal_score, color = \u0026quot;men|verbal\u0026quot;))+\rgeom_line(mapping = aes(y = wonem_verbal_score, color = \u0026quot;women|verbal\u0026quot;))+\rscale_color_manual(values = c(\u0026quot;men|verbal\u0026quot; = \u0026quot;blue\u0026quot;,\r\u0026quot;women|verbal\u0026quot; = \u0026quot;red\u0026quot;),\rname = \u0026quot;\u0026quot;)+\rtheme_graph()+\rlabs(x = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rmath_graph \u0026lt;- table_2.9_sat_scores %\u0026gt;% ggplot2::ggplot(mapping = aes(x = year))+\rgeom_line(mapping = aes(y = men_math_score, color = \u0026quot;men|math\u0026quot;))+\rgeom_line(mapping = aes(y = women_math_score, color = \u0026quot;women|math\u0026quot;))+\rscale_color_manual(values = c(\u0026quot;men|math\u0026quot; = \u0026quot;blue\u0026quot;,\r\u0026quot;women|math\u0026quot; = \u0026quot;red\u0026quot;),\rname = \u0026quot;\u0026quot;)+\rtheme_graph()+\rlabs(x = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rverbal_graph + math_graph +\rpatchwork::plot_annotation(title = \u0026quot;Comparativo de Notas Entre os Gêneros\u0026quot;,\rsubtitle = \u0026quot;Teste SAT dos EUA\u0026quot;)\rb. Que conclusões gerais você tirou desses gráficos?\nHomens se saem melhores em ambos os testes e (ii) o teste de matemática ou foi ficando mais fácil ao longo dos anos ou os alunos foram se preparando melhor para fazê-lo. Também nota-se uma correlação entre os desempenhos em ‘Verbal’ e ‘Math’.\r\rc. Conhecendo a pontuação de homens e mulheres nos testes de aptidão verbal, você poderia prever suas notas em matemática?\nAnalisando a série temporal do exercício ‘a’, parece ser possível esta regressão.\nd. Represente graficamente as notas de matemática das mulheres em relação às dos homens. O que você observa?\ntable_2.9_sat_scores %\u0026gt;% ggplot2::ggplot()+\rgeom_point(mapping = aes(x = women_math_score, y = men_math_score),\rshape = 2,\rcolor = \u0026quot;dark orange\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Relação Entre Nota de Mulheres e Homens\u0026quot;,\rsubtitle = \u0026quot;Exame de Matemática (SAT)\u0026quot;,\rx = \u0026quot;Mulheres\u0026quot;,\ry = \u0026quot;Homens\u0026quot;)\r\r\rCapítulo 3\r3.18. Na Tabela 3.5 está a classificação de dez estudantes nas provas parcial e final de estatística. Calcule o coeficiente de correlação de rankings de Spearman e interprete os resultados.\nComo a tabela 3.5 é pequena, vou colocar os valores manualmente.\ntable_3.5 \u0026lt;- data.frame(parcial_test = c(1,3,7,10,9,5,4,8,2,6),\rfinal_test = c(3,2,8,7,9,6,5,10,1,4),\rstudent = c(\u0026quot;a\u0026quot;,\u0026quot;b\u0026quot;,\u0026quot;c\u0026quot;,\u0026quot;d\u0026quot;,\u0026quot;e\u0026quot;,\u0026quot;f\u0026quot;,\u0026quot;g\u0026quot;,\u0026quot;h\u0026quot;,\u0026quot;i\u0026quot;,\u0026quot;j\u0026quot;))\rcor.test(x = table_3.5$parcial_test, y = table_3.5$final_test,\rmethod = \u0026quot;spearman\u0026quot;)\r## ## Spearman\u0026#39;s rank correlation rho\r## ## data: table_3.5$parcial_test and table_3.5$final_test\r## S = 26, p-value = 0.004459\r## alternative hypothesis: true rho is not equal to 0\r## sample estimates:\r## rho ## 0.8424242\r3.19. A relação entre a taxa de câmbio nominal e os preços relativos. Com base nas observações anuais de 1985 a 2005, obteve-se a seguinte regressão, em que Y D taxa de câmbio do dólar canadense em relação ao dólar americano (DC/$) e X D razão do IPC americano pelo IPC canadense, isto é, X representa os preços relativos dos dois países:\na. Interprete a regressão. Como você interpretaria r²?\nR: r² em 44% indica que a variação de Y possui outras variáveis explicativas que precisam ser inseridas no modelo. O erro padrão está baixo (acredito que seja estatisticamente significativo no modelo), portanto apesar de um r² baixo, o modelo se mostra confiável na explicação das variações de Y.\nb. O valor positivo de X_t faz sentido econômico? Qual a teoria econômica em que se embasa?\nR: Faz sentido, visto que \\(X_t\\) indica a razão entre Inflação dos EUA e do Canadá, e sabendo que a inflação corri o poder de compra da moeda e impacta na taxa de câmbio, se a Inflação dos EUA estiver maior que a do Canadá, a relação (DC/$) será afetada, onde o dólar ficará mais fraco frente ao dólar canadense (gerando aumento em Y, explicado pelo valor positivo de \\(X_t\\)).\nc. Suponha que X seja redefinido como a razão entre o IPC canadense e o IPC americano. Isso mudaria o sinal de X? Por quê?\nR: Mudaria, visto que Y continuaria sendo (DC/$).\n3.20. A Tabela 3.6 apresenta dados relativos a índices de produção por hora (X) e remuneração real por hora (Y) para os setores empresarial e empresarial não agrícola da economia dos Estados Unidos no período 1960-2005. O ano-base dos índices é 1992 D 100 e os índices foram ajustados sazonalmente\ntable_3.6_wage_and_productivity \u0026lt;-\rreadr::read_delim(file = paste(dataset_path,\r\u0026quot;table_3.6_wage_and_productivity.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;) %\u0026gt;% tidyr::gather(\u0026quot;metric\u0026quot;,\u0026quot;value\u0026quot;,2:5) %\u0026gt;% mutate(value = value/10) %\u0026gt;% tidyr::spread(\u0026quot;metric\u0026quot;,\u0026quot;value\u0026quot;)\rtable_3.6_wage_and_productivity %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;, decimal.mark = \u0026quot;,\u0026quot;))\r\r\r\ryear\r\rcorporate\r\rcorporate_wages\r\rnon_agricultural\r\rnon_agricultural_wages\r\r\r\r\r\r1.960\r\r48,9\r\r60,8\r\r51,9\r\r63,3\r\r\r\r1.961\r\r50,6\r\r62,5\r\r53,5\r\r64,8\r\r\r\r1.962\r\r52,9\r\r64,6\r\r55,9\r\r66,7\r\r\r\r1.963\r\r55,0\r\r66,1\r\r57,8\r\r68,1\r\r\r\r1.964\r\r56,8\r\r67,7\r\r59,6\r\r69,3\r\r\r\r\ra. Represente graficamente Y contra X para os dois setores da economia separadamente.\ntable_3.6_wage_and_productivity %\u0026gt;% ggplot2::ggplot()+\rgeom_point(mapping = aes(x = corporate, y = corporate_wages,\rcolor = \u0026quot;Setor Empresarial\u0026quot;),\rshape = 3)+\rgeom_point(mapping = aes(x = non_agricultural, y = non_agricultural_wages,\rcolor = \u0026quot;Setor Não Agrícola\u0026quot;),\rshape = 2)+\rscale_color_manual(values = c(\u0026quot;Setor Empresarial\u0026quot; = \u0026quot;Steel Blue\u0026quot;,\r\u0026quot;Setor Não Agrícola\u0026quot; = \u0026quot;Dark Orange\u0026quot;),\rname = \u0026quot;Setores\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Relação Entre Produção por Hora e Salários\u0026quot;,\rx = \u0026quot;Produção por Hora\u0026quot;,\ry = \u0026quot;Salário\u0026quot;)\rb. Qual a teoria econômica que embasa a relação entre as duas variáveis? O gráfico de dispersão confirma a teoria?\nR: Não sei dizer a teoria econômica que fundamenta esta relação direta, porém é esperado que a produtividade gere ganhos salariais, visto que se cria mais valor pra sociedade em um mesmo intervalo de tempo.\nc. Estime uma regressão de MQO de Y contra X. Guarde os resultados para examiná-los novamente depois de estudar o Capítulo 5.\nCada setor terá uma regressão estimada.\n\rSetor Empresarial\r\rtable_3.6_wage_and_productivity %\u0026gt;% lm(formula = \u0026quot;corporate_wages ~ corporate\u0026quot;) %\u0026gt;% summary() %\u0026gt;% pander::pander()\r\r\r\r\rEstimate\rStd. Error\rt value\rPr(\u0026gt;|t|)\r\r\r\r(Intercept)\r32.74\r1.394\r23.49\r1.584e-26\r\rcorporate\r0.6704\r0.01567\r42.78\r1.724e-37\r\r\r\rFitting linear model: “corporate_wages ~ corporate”\r\r\r\rObservations\rResidual Std. Error\r\\(R^2\\)\rAdjusted \\(R^2\\)\r\r\r\r46\r2.384\r0.9765\r0.976\r\r\r\rtable_3.6_wage_and_productivity %\u0026gt;% lm(formula = \u0026quot;non_agricultural_wages ~ non_agricultural\u0026quot;) %\u0026gt;% summary() %\u0026gt;% pander::pander()\r\r\r\r\rEstimate\rStd. Error\rt value\rPr(\u0026gt;|t|)\r\r\r\r(Intercept)\r32.39\r1.39\r23.3\r2.214e-26\r\rnon_agricultural\r0.6711\r0.0155\r43.29\r1.033e-37\r\r\r\rFitting linear model: “non_agricultural_wages ~ non_agricultural”\r\r\r\rObservations\rResidual Std. Error\r\\(R^2\\)\rAdjusted \\(R^2\\)\r\r\r\r46\r2.244\r0.9771\r0.9765\r\r\r\r3.23. A Tabela 3.8 apresenta dados do produto interno bruto (PIB) dos Estados Unidos no período 1959-2005.\ntable_3.8_usa_gdp_nominal_and_real \u0026lt;-\rreadr::read_delim(file = paste(dataset_path,\r\u0026quot;table_3.8_usa_gdp_nominal_and_real.txt\u0026quot;, sep = \u0026quot;\u0026quot;),\rdelim = \u0026quot; \u0026quot;)\rtable_3.8_usa_gdp_nominal_and_real %\u0026gt;% head(5) %\u0026gt;% knitr::kable(format.args = list(big.mark = \u0026quot;.\u0026quot;,\rdecimal.mark = \u0026quot;,\u0026quot;))\r\r\r\ryear\r\rnominal_gdp\r\rreal_gdp\r\r\r\r\r\r1.959\r\r506,6\r\r2.441,3\r\r\r\r1.960\r\r526,4\r\r2.501,8\r\r\r\r1.961\r\r544,7\r\r2.560,0\r\r\r\r1.962\r\r585,6\r\r2.715,2\r\r\r\r1.963\r\r617,7\r\r2.834,0\r\r\r\r\ra. Represente graficamente os dados do PIB em dólares correntes e em dólares constantes (de 2000) em relação ao tempo.\ntable_3.8_usa_gdp_nominal_and_real %\u0026gt;% ggplot2::ggplot()+\rgeom_line(mapping = aes(x = year, y = nominal_gdp, color = \u0026quot;Nominal\u0026quot;))+\rgeom_line(mapping = aes(x = year, y = real_gdp, color = \u0026quot;Real\u0026quot;))+\rscale_color_manual(values = c(\u0026quot;Nominal\u0026quot; = \u0026quot;Dark Orange\u0026quot;,\r\u0026quot;Real\u0026quot; = \u0026quot;Steel Blue\u0026quot;))+\rtheme_graph()+\rlabs(title = \u0026quot;PIB dos EUA, Nominal e Real\u0026quot;,\rx = \u0026quot;Year\u0026quot;,\ry = \u0026quot;GDP\u0026quot;)\rb. Denotando o PIB por Y e o tempo por X (medido em uma sequência cronológica em que l represente 1959, 2, 1960 e assim por diante até 47 para 2005), veja se o seguinte modelo ajusta-se aos dados do PIB:\n\\[y_t = \\beta_1 + \\beta_2 x_t + \\mu_t\\]\nApenas pelo gráfico dá para se notar uma relação entre tempo e variação do PIB. Algo que é bem comum em séries temporais, onde se incluem modelos de regressão para fazer o ‘forecasting’. Vamos ver se o modelo se adequa bem aos dados.\n\rPIB Nominal\r\rtable_3.8_usa_gdp_nominal_and_real %\u0026gt;%\rlm(formula = \u0026quot;nominal_gdp ~ year\u0026quot;) %\u0026gt;% summary() %\u0026gt;% pander::pander()\r\r\r\r\rEstimate\rStd. Error\rt value\rPr(\u0026gt;|t|)\r\r\r\r(Intercept)\r-496268\r21089\r-23.53\r6.286e-27\r\ryear\r252.6\r10.64\r23.74\r4.367e-27\r\r\r\rFitting linear model: “nominal_gdp ~ year”\r\r\r\rObservations\rResidual Std. Error\r\\(R^2\\)\rAdjusted \\(R^2\\)\r\r\r\r47\r989.5\r0.926\r0.9244\r\r\r\r\rPIB Real\r\rtable_3.8_usa_gdp_nominal_and_real %\u0026gt;%\rlm(formula = \u0026quot;real_gdp ~ year\u0026quot;) %\u0026gt;% summary() %\u0026gt;% pander::pander()\r\r\r\r\rEstimate\rStd. Error\rt value\rPr(\u0026gt;|t|)\r\r\r\r(Intercept)\r-351335\r9070\r-38.74\r3.332e-36\r\ryear\r180.3\r4.576\r39.39\r1.597e-36\r\r\r\rFitting linear model: “real_gdp ~ year”\r\r\r\rObservations\rResidual Std. Error\r\\(R^2\\)\rAdjusted \\(R^2\\)\r\r\r\r47\r425.6\r0.9718\r0.9712\r\r\r\rc. Como você interpretaria \\(\\beta_2\\)?\nPara ambas as variáveis (Nominal e Real), o tempo se mostra estatisticamente significativo (com valor p bastante baixo) e também nos dois modelos a capacidade de explicar variações em Y é alta (demonstrado pelo r²).\n\r","date":1583020800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1583020800,"objectID":"7906c460838ab104dfbfbf626fdfedd5","permalink":"https://francisco.piccolo.com/post/2020-03-03-basic-econometrics-by-gujarati-and-porter/","publishdate":"2020-03-01T00:00:00Z","relpermalink":"/post/2020-03-03-basic-econometrics-by-gujarati-and-porter/","section":"post","summary":"Econometria é uma ferramenta (ou técnica) muito usada por economistas, estatísticos e também por outras ciências. Uma definição encontrada nos livros básicos é:\n\r“Econometria é a aplicação de modelos estatísticos em dados econômicos”","tags":null,"title":"Econometria Básica de Gujarati e Porter: Resolvendo Exercícios Propostos","type":"post"},{"authors":null,"categories":null,"content":"\r\rA imigração vem sendo um tema central nos debates políticos para presidencia, gerando muitas dúvidas nos eleitores, por conta de fake news que acabam surgindo, e também muita esperança para as pessoas que buscam mudar de vida com a mudança de país. Esta onda imigratória está cada vez chamando mais a atenção da mídia, por conta da grave crise na Syria, Yemen e Venezuela, que fez com que milhões de pessoas decidissem sair de seus lares.\nEsta atenção da mídia fez com que estudos mais aprofundados sobre o tema surgissem, visando desmistificar alguns fatos sobre o tema. Um estudo que me chamou bastante a atenção foi o realizado pela The Economist, onde se conduziram diversas reportagens sobre aspectos do fluxo imigratório, como o impacto nos países que recebem as pessoas, empregabilidade, bem-estar, entre outros. A reportagem foi muito bem feita e o tema me atrai bastante, por isso resolvi fazer este post, para tentar analisar os dados do fluxo imigratório.\nNa tentativa de complementar os insights gerados pela reportagem, vou usar os dados do Banco Mundial, através de uma API que pode ser acessada pelo R com o pacote wbstats. Esta API me permitirá acessar o banco de dados desta instituição, que me parece ser a melhor fonte para dados de fluxo imigratório.\nA imagem abaixo é de uma das reportagens da revista. Fantástica!\nAntes de iniciar a análise dos dados, vou listar abaixo as principais conclusões das reportagens desenvolvidas nesta edição da The Economist.\nPessoas que conseguem migrar de seus países, geralmente saindo de um país pobre e imigrando para um país rico, auferem um aumento de 3 a 6 vezes em sua renda, por conta de que países ricos possuem melhores instituições, melhor alocação de capital e empresas mais modernas.\n\rSe todas as pessoas que desejassem se mudar de país conseguissem, o PIB mundial poderia dobrar, por conta de que a mão de obra e o capital estaria sendo melhor utilizado.\n\rImigrantes têm mais chance de abrir seu próprio negócio no país em que entram, pois conseguem notar com mais facilidade demandas não atendidas, e também por conta de que descobrem soluções alternativas para problemas existentes na sociedade em que entram. Em outras palavras, os imigrantes olham para as necessidades da sociedade em que entram com outra perspectiva, pensando fora da caixa.\n\rO maior “problema” com relação à imigração é a mudança cultural (se é que se pode chamar isso de um problema), que ocorre rapidamente em locais que recebem um fluxo imigratório, por conta de que os imigrantes de agrupam em locais específicos. Além de ser o principal problema, é algo difícil de se solucionar, pois é difícil mensurá-lo e contestá-lo.\n\rAs pessoas são mais tolerantes ao fluxo imigratório em seus países quando notam que seu governo está sob controle da situação e também das fronteiras de seu país\n\rOs imigrantes na maioria das vezes compartilham seus rendimentos com seus familiares que ficaram no país de origem. Esta forma de investimento é chamada de remittances. Estas remessas já constituem a maior fonte de investimento direto externo de alguns países e seu potencial de impacto é alto, visto que é um investimento que vai direto para as pessoas que precisam e o risco de serem desviada por corrupção é menor. Atualmente, em 28 países, estas remessas representam mais de 10% de seus respectivos PIBs.\n\r\rAnalisando os Dados do Fluxo Imigratório\rAgora que entendemos alguns aspectos do fluxo imigratório, nós podemos analisar alguns datasets da base de dados do Banco Mundial para nos aprofundar um pouco mais no tema. Para isso, vamos usar os seguintes pacotes.\nlibrary(tidyverse) # data science and data manipulation packages\rlibrary(wbstats) # World Bank API\rlibrary(patchwork)\rtheme_graph \u0026lt;- function(){\rtheme(\rplot.title = element_text(size = 15),\rplot.subtitle = element_text(size = 9),\rplot.caption = element_text(face = \u0026quot;italic\u0026quot;, size = 7),\raxis.text = element_text(size = 8),\raxis.title = element_text(face = \u0026quot;italic\u0026quot;, size = 8),\rstrip.background = element_rect(fill = \u0026quot;grey\u0026quot;),\rstrip.text = element_text(face = \u0026quot;bold\u0026quot;),\rlegend.title = element_blank(),\rlegend.position = \u0026quot;bottom\u0026quot;\r)\r}\rA primeira informação que vale a pena ser vista sobre o tema é a quantidade de pessoas consideradas imigrantes pelo Banco Mundial. O gráfico abaixo irá mostrar a série temporal desta variável.\nO código abaixo salva na variável ‘migrants_pop’ o resultado da chamada da API do Banco Mundial. Veja que é necessário especificar qual indicator se deseja trazer, o período e quais países para ser retornado.\n# Creating a variable with the data.frame of the requested data\rmigrants_pop \u0026lt;- wbstats::wb(indicator = \u0026quot;SM.POP.TOTL\u0026quot;,\rcountry = \u0026quot;countries_only\u0026quot;,\rstartdate = 1980,\renddate = 2020)\rApós fazer a requisição, é possível plotar a série temporal.\nmigrants_pop %\u0026gt;% group_by(date) %\u0026gt;% summarise(immigrants = sum(value)) %\u0026gt;% ggplot()+\rgeom_line(mapping = aes(x = date, y = immigrants, group = 1), size = .5, color = \u0026quot;dark orange\u0026quot;,\ralpha = .6)+\rgeom_point(mapping = aes(x = date, y = immigrants),\rcolor = \u0026quot;dark orange\u0026quot;)+\rscale_y_continuous(labels = scales::comma)+\rtheme_graph()+\rlabs(title = \u0026quot;População Imigrante ao Longo do Tempo\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rVeja que o dataset trouxe dados até 2015, mesmo eu tendo solicitado até 2020. Em 2015 a população imigrante era de 250 milhões (maior do que a população do Brasil). Agora vamos verificar os países que possuem maior proporção de imigrantes em seus territórios. O próximo gráfico irá trazer os 20 países com maior proporção de população imigrante. Provavelmente Canadá e Austrália estarão presentes neste rank. Irei remover países com população abaixo de 1 milhão de habitantes.\n# Trazendo a população dos países\rpopulation \u0026lt;- wbstats::wb(indicator = \u0026quot;SP.POP.TOTL\u0026quot;,\rcountry = \u0026quot;countries_only\u0026quot;)\r# Juntando os dois datasets de população e imigrantes\rmigrants_pop %\u0026gt;% filter(date == \u0026quot;2015\u0026quot;) %\u0026gt;% select(country, date, value) %\u0026gt;% inner_join(population, by = c(\u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;, \u0026quot;date\u0026quot; = \u0026quot;date\u0026quot;)) %\u0026gt;%\rmutate(share_immigrants = round(value.x/value.y, digits = 4)) %\u0026gt;% filter(value.y \u0026gt;= 1000000) %\u0026gt;% # Retirando países com baixa população\rarrange(desc(share_immigrants)) %\u0026gt;% head(20) %\u0026gt;% mutate(country = fct_reorder(country, share_immigrants)) %\u0026gt;% ggplot()+\rgeom_col(mapping = aes(x = country, y = share_immigrants),\rfill = \u0026quot;steel blue\u0026quot;)+\rscale_y_continuous(labels = scales::percent)+\rtheme_graph()+\rlabs(title = \u0026quot;Países com Maior Proporção de Imigrantes\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;% de Imigrantes no País\u0026quot;)+\rcoord_flip()\rAlguns países me surpreenderam estar na lista, como por exemplo Arábia Saudita. Este artigo reforça esse número.\nSe por um lado, alguns países receberam muitos imigrantes, por outro, alguns países perderam muitos residentes. Vamos ver os países que mais perderam residentes nos últimos anos. O Banco Mundial possui um indicador que mostra a saída líquida de pessoas, e com essa métrica, podemos classificar os países do menor valor para o maior e selecionar os 20 primeiros. Com isso, o resultado será os 20 países que mais perderam pessoas.\nnet_immigration \u0026lt;- wbstats::wb(indicator = \u0026quot;SM.POP.NETM\u0026quot;,\rcountry = \u0026quot;countries_only\u0026quot;,\rstartdate = 2010,\renddate = 2019) %\u0026gt;% select(country, value, date)\r# Dataset sample\rnet_immigration[sample(nrow(net_immigration),5), ] %\u0026gt;% knitr::kable(format.args = list(decimal.mark = \u0026quot;,\u0026quot;, big.mark = \u0026quot;.\u0026quot;))\r\r\r\rcountry\rvalue\rdate\r\r\r\r1803\rSlovak Republic\r7.423\r2017\r\r148\rBelgium\r258.672\r2012\r\r1663\rRwanda\r-44.998\r2017\r\r2033\rUnited States\r4.774.029\r2017\r\r1588\rKorea, Dem. People’s Rep.\r-27.013\r2012\r\r\r\rnet_immigration %\u0026gt;% group_by(country) %\u0026gt;% summarise(net_immigration = sum(value)) %\u0026gt;% arrange(net_immigration) %\u0026gt;% head(20) %\u0026gt;% mutate(net_immigration = net_immigration * -1,\rcountry = fct_reorder(country, net_immigration)) %\u0026gt;% ggplot()+\rgeom_col(mapping = aes(x = country, y = net_immigration),\rfill = \u0026quot;steel blue\u0026quot;)+\rscale_y_continuous(labels = scales::comma)+\rtheme_graph()+\rcoord_flip()+\rlabs(title = \u0026quot;Países que Mais Perderam Imigrantes desde 2010\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rSíria e Venezuela são dois países que eu esperava ver neste gráfico. Porém Índia e China aparecem por conta de sua grande população, pois um pequeno movimento de seus habitantes é algo grande comparado aos outros. O ideal é normalizar este dataset usando a população de cada país, de forma que a saída de pessoas seja relativa à sua população. Para isso, basta cruzarmos este dataset com o dataset de população do país para criar a métrica de ‘saída líquida relativa de pessoas’.\n# Net immigration summed during the period\rnet_immigration %\u0026gt;% group_by(country) %\u0026gt;% summarise(net_immigration = sum(value)) -\u0026gt; net_immigration\r# Joinning the population and net_immigration data\rpopulation %\u0026gt;% filter(date == 2015) %\u0026gt;%\rmutate(population = value) %\u0026gt;% select(country, population) %\u0026gt;% inner_join(net_immigration, by = c(\u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;)) %\u0026gt;% mutate(net_immigration_share = round(net_immigration/population, digits = 4)) %\u0026gt;% arrange(net_immigration_share) %\u0026gt;% head(20) %\u0026gt;% mutate(net_immigration_share = net_immigration_share * -1,\rcountry = fct_reorder(country, net_immigration_share)) %\u0026gt;% ggplot()+\rgeom_col(mapping = aes(x = country, y = net_immigration_share),\rfill = \u0026quot;steel blue\u0026quot;)+\rscale_y_continuous(labels = scales::percent)+\rtheme_graph()+\rcoord_flip()+\rlabs(title = \u0026quot;Saída Relativa de Pessoas dos Países\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;,\rcaption = \u0026quot;De 2010 até 2017\u0026quot;)\rCom essa visão ajustada, podemos ver outros países compondo o ranking. Seguindo adiante, vamos verificar as ‘remittances’ que são enviadas por imigrantes para seus familiares que estão em dificuldades. Um dado importante indicado nas reportagens da revista é que este fluxo de investimento direto representa mais de 10% do PIB de 29 países. Vamos ver se este indicador é corroborado pelo dataset do Banco Mundial.\nPor sorte o Banco Mundial já mensura o percentual de ‘remittances’ sobre o PIB, desta forma desenvolver esta tabela ficou bem simples.\nremitances_over_gdp \u0026lt;- wbstats::wb(indicator = \u0026quot;BX.TRF.PWKR.DT.GD.ZS\u0026quot;,\rcountry = \u0026quot;countries_only\u0026quot;)\rremitances_over_gdp %\u0026gt;% filter(date == \u0026quot;2018\u0026quot;,\rcountry != \u0026quot;Lesotho\u0026quot;,\rvalue \u0026gt; 10) %\u0026gt;%\rmutate(\u0026quot;Remittance over gdp\u0026quot; = paste(round(value,digits = 2),\u0026quot;%\u0026quot;,sep = \u0026quot;\u0026quot;)) %\u0026gt;% arrange(desc(value)) %\u0026gt;% mutate(rows = row_number()) %\u0026gt;% select(rows, date, country, \u0026quot;Remittance over gdp\u0026quot;) %\u0026gt;% knitr::kable(format.args = list(decimal.mark = \u0026quot;,\u0026quot;, big.mark = \u0026quot;.\u0026quot;))\r\r\rrows\rdate\rcountry\rRemittance over gdp\r\r\r\r1\r2018\rTonga\r37.49%\r\r2\r2018\rKyrgyz Republic\r32.51%\r\r3\r2018\rTajikistan\r29.02%\r\r4\r2018\rNepal\r28.43%\r\r5\r2018\rEl Salvador\r20.63%\r\r6\r2018\rBermuda\r19.99%\r\r7\r2018\rHonduras\r19.88%\r\r8\r2018\rHaiti\r19.68%\r\r9\r2018\rSamoa\r17.94%\r\r10\r2018\rWest Bank and Gaza\r17.41%\r\r11\r2018\rYemen, Rep.\r16.05%\r\r12\r2018\rMoldova\r16.04%\r\r13\r2018\rJamaica\r15.92%\r\r14\r2018\rKosovo\r15.56%\r\r15\r2018\rUzbekistan\r15.1%\r\r16\r2018\rMarshall Islands\r14.21%\r\r17\r2018\rLiberia\r14.09%\r\r18\r2018\rComoros\r13.8%\r\r19\r2018\rGuatemala\r12.91%\r\r20\r2018\rLebanon\r12.7%\r\r21\r2018\rGambia, The\r12.19%\r\r22\r2018\rArmenia\r11.94%\r\r23\r2018\rCabo Verde\r11.87%\r\r24\r2018\rGeorgia\r11.56%\r\r25\r2018\rNicaragua\r11.52%\r\r26\r2018\rUkraine\r11.23%\r\r27\r2018\rBosnia and Herzegovina\r11.21%\r\r28\r2018\rMontenegro\r10.7%\r\r29\r2018\rSenegal\r10.45%\r\r30\r2018\rJordan\r10.42%\r\r31\r2018\rEgypt, Arab Rep.\r10.22%\r\r32\r2018\rKiribati\r10.15%\r\r\r\rAparentemente são 31 países nesta situação, o que corrobora o que foi indicado na reportagem, visto que alguns países desta tabela são bem pequenos, e podem ter sido desconsiderados pela revista.\nOutra informação indicada nas reportagens é de que as remessas enviadas pelos familiares aos seus parentes é um fluxo acíclico. Isso quer dizer que o fluxo não varia em conformidade com a variação do PIB do país que recebe este investimento. Essa hipótese tem um fundamento sólido, visto que o imigrante, ao ver seus parentes precisando de ajuda (por conta de uma crise econômica), envia mais dinheiro para que eles consigam passar por esta situação adversa. Apesar deste embasamento, é necessário ver empiricamente esta afirmação.\nVou selecionar alguns países com baixo PIB per capita para ver se o fluxo de ‘remittances’ de fato assume um comportamento acíclico. Os países serão:\rSuriname, Somalia, Serra Leoa, Senegal, Sudão, Ruanda, Nepal, Nigéria, Malawi, Mali, Líbia, Quênia, Etiópia, Eritreia e Congo.\nAgora vamos ver o fluxo de ‘remittances’ e o PIB per Capita.\nTendo as duas variáveis, antes de compará-las, será necessário normalizar o fluxo de ‘remittances’ pela população. O seguinte código fará esta normalização.\nremitances_received %\u0026gt;% mutate(remitances = value) %\u0026gt;% select(date, country, remitances) %\u0026gt;% filter(country %in% country_view,\rdate \u0026gt; 2010) %\u0026gt;% inner_join(population, by = c(\u0026quot;date\u0026quot; = \u0026quot;date\u0026quot;, \u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;)) %\u0026gt;% select(date, country, remitances, value) %\u0026gt;% mutate(remitances_adj = round(remitances/value, digits = 4)) %\u0026gt;% select(date, country, remitances_adj) -\u0026gt; remitances\r# Gerando uma amostra do dataset\rremitances[sample(nrow(remitances),5), ] %\u0026gt;% knitr::kable(caption = \u0026quot;Amostra do dataset\u0026quot;)\r\rTable 1: Amostra do dataset\r\r\rdate\rcountry\rremitances_adj\r\r\r\r19\r2016\rKenya\r35.5674\r\r67\r2013\rRwanda\r15.7424\r\r52\r2019\rNepal\r288.3564\r\r24\r2011\rKenya\r21.6345\r\r33\r2011\rMali\r50.5400\r\r\r\rAgora eu posso cruzar os dois datasets para ver a correlação das duas variáveis para os países selecionados.\ngdp \u0026lt;- gdp_pc %\u0026gt;% mutate(gdp_pc = value) %\u0026gt;% select(date, country, gdp_pc) %\u0026gt;% inner_join(remitances, by = c(\u0026quot;date\u0026quot; = \u0026quot;date\u0026quot;, \u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;)) %\u0026gt;%\rgroup_by(date) %\u0026gt;% summarise(gdp = sum(gdp_pc),\rremitance = sum(remitances_adj)) %\u0026gt;% ggplot()+\rgeom_line(mapping = aes(x = date, y = gdp, group = 1),\rcolor = \u0026quot;dark orange\u0026quot;, size = 1)+\rscale_y_continuous(labels = scales::comma)+\rtheme_graph()+\rlabs(title = \u0026quot;PIB per Capita\u0026quot;)\rremittances \u0026lt;- gdp_pc %\u0026gt;% mutate(gdp_pc = value) %\u0026gt;% select(date, country, gdp_pc) %\u0026gt;% inner_join(remitances, by = c(\u0026quot;date\u0026quot; = \u0026quot;date\u0026quot;, \u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;)) %\u0026gt;%\rgroup_by(date) %\u0026gt;% summarise(gdp = sum(gdp_pc),\rremitance = sum(remitances_adj)) %\u0026gt;% ggplot()+\rgeom_line(mapping = aes(x = date, y = remitance, group = 1),\rcolor = \u0026quot;steel blue\u0026quot;, size = 1)+\rscale_y_continuous(labels = scales::comma)+\rtheme_graph()+\rlabs(title = \u0026quot;Remittances per Capita\u0026quot;)\rgdp+remittances\rNota-se que a relação não é direta, porém também não é inversa. Desta forma, esta relação acíclica não fica evidente ao vermos estas duas séries temporais. O gráfico abaixo mostra a correlação destas duas séries temporais.\ngdp_pc %\u0026gt;% mutate(gdp_pc = value) %\u0026gt;% select(date, country, gdp_pc) %\u0026gt;% inner_join(remitances, by = c(\u0026quot;date\u0026quot; = \u0026quot;date\u0026quot;, \u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;)) %\u0026gt;% ggplot()+\rgeom_point(mapping = aes(x = remitances_adj, y = gdp_pc))+\rgeom_smooth(mapping = aes(x = remitances_adj, y = gdp_pc),\rmethod = \u0026quot;lm\u0026quot;,\rformula = y ~ x,\rse = F,\rlty = 2,\rcolor = \u0026quot;dark orange\u0026quot;)+\rscale_y_continuous(labels = scales::comma)+\rscale_x_continuous(labels = scales::comma)+\rtheme_graph()+\rlabs(title = \u0026quot;Correlação do PIB per Capita e \u0026#39;Remittances\u0026#39;\u0026quot;,\ry = \u0026quot;PIB per Capita\u0026quot;,\rx = \u0026quot;Remitances\u0026quot;)\rEu esperava ver uma correlação mais forte, onde o PIB per Capito reduzido iria trazer um valor de ‘remittances’ per Capita alto. Porém não ficou tão clara esta correlação. O modelo de regressão linear para este contexto pode ser do seguinte formato:\n\\[R = \\beta_0 + \\beta_1 pc.gdp + \\mu\\]\nEste modelo tentará explicar variações do fluxo de ‘remittances’ per Capita em função do PIB per Capita, de forma que se possa prever o valor da variável dependente com um dado grau de confiança.\ngdp_pc %\u0026gt;% mutate(gdp_pc = value) %\u0026gt;% select(date, country, gdp_pc) %\u0026gt;% inner_join(remitances, by = c(\u0026quot;date\u0026quot; = \u0026quot;date\u0026quot;, \u0026quot;country\u0026quot; = \u0026quot;country\u0026quot;)) %\u0026gt;%\rlm(formula = remitances_adj ~ gdp_pc) %\u0026gt;% summary() %\u0026gt;% pander::pander()\r\r\r\r\rEstimate\rStd. Error\rt value\rPr(\u0026gt;|t|)\r\r\r\r(Intercept)\r25.88\r9.849\r2.628\r0.009635\r\rgdp_pc\r0.03021\r0.00591\r5.111\r1.118e-06\r\r\r\rFitting linear model: remitances_adj ~ gdp_pc\r\r\r\rObservations\rResidual Std. Error\r\\(R^2\\)\rAdjusted \\(R^2\\)\r\r\r\r132\r67.74\r0.1673\r0.1609\r\r\r\rCom o output do modelo, podemos reescrever a equação inserindo os valores do intercepto e inclinação.\n\\[R = 19.29 + 0.03542 pc.gdp + \\mu\\]\nEmbora o resultado tenha saído diferente do que eu esperava, tanto o intercepto quanto a inclinação se mostram estatisticamente significativos, com um valor-p abaixo de 5%.\n\r","date":1579478400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579478400,"objectID":"565aa8f2b170aacc945668961bfbe9b9","permalink":"https://francisco.piccolo.com/post/2020-01-20-imigration-data-analysis/","publishdate":"2020-01-20T00:00:00Z","relpermalink":"/post/2020-01-20-imigration-data-analysis/","section":"post","summary":"A imigração vem sendo um tema central nos debates políticos para presidencia, gerando muitas dúvidas nos eleitores, por conta de fake news que acabam surgindo, e também muita esperança para as pessoas que buscam mudar de vida com a mudança de país.","tags":null,"title":"Analisando o Fluxo Imigratório com R","type":"post"},{"authors":null,"categories":null,"content":"\r\r\rO modelo de regressão linear é bastante usado na predição de variáveis contínuas, onde há uma ou mais variáveis independentes buscando mapear o comportamento de uma variável dependente. O modelo é bastante simples e lembro ser um dos primeiros a ser ensinado nas aulas de econometria. Porém, apesar de sua simplicidade, é preciso se atentar a alguns detalhes sobre suas premissas para que os resultados deste modelo possam ser usados para a tomada de decisão.\nAbaixo vou listar algumas das premissas da regressão linear:\nAusência de multicolinearidade entre as variáveis independentes.\n\rAusência de autocorrelação na variável dependente.\n\rAbsence of pattern on the behavior of the model residuals, in other words, absence of heteroscedasticity.\n\rAusência de padrão no comportamento dos resíduos do modelo, ou seja, ausência de heterocedasticidade.\n\rResíduos se distribuem de acordo com uma distribuição normal.\n\r\rTendo estas premissas atendidas, o modelo pode gerar conclusões confiáveis. Neste post eu vou desenvolver alguns modelos de regressão linear para testar as premissas iii e iv que tratam dos resíduos, para ver alguns casos práticos.\nPara começar, vamos trazer os pacotes necessários para execução das funções no R:\nlibrary(tidyverse)\rlibrary(lmtest)\rlibrary(corrplot)\rlibrary(readxl)\rTambém vou criar uma função para facilitar a padronização dos gráficos que serão gerados.\ntheme_graph \u0026lt;- function(){\rtheme(\rplot.title = element_text(size = 16),\rplot.subtitle = element_text(size = 12),\rplot.caption = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\raxis.text = element_text(size = 9),\raxis.title = element_text(face = \u0026quot;italic\u0026quot;, size = 9),\rstrip.background = element_rect(fill = \u0026quot;grey\u0026quot;),\rstrip.text = element_text(face = \u0026quot;bold\u0026quot;),\rlegend.title = element_blank(),\rlegend.position = \u0026quot;bottom\u0026quot;,\rpanel.grid.major = element_line(\rrgb(198, 198, 216, maxColorValue = 255),\rlinetype = \u0026quot;dotted\u0026quot;), panel.grid.minor = element_line(\rrgb(198, 198, 216, maxColorValue = 255),\rlinetype = \u0026quot;dotted\u0026quot;),\rpanel.background = element_rect(fill = \u0026quot;#FEFDFF\u0026quot;)\r)\r}\rExemplo 1: Elasticidade preço x oferta na produção de cana de açúcar.\rEste exemplo foi passado na minha aula de econometria em 2017. Na época o exercício foi realizado com o software EViews, por sorte eu guardei os dados e agora posso refazer o problema com mais facilidade com o uso do R.\nNo exercício, há a variável independente (X) sendo o preço da cana de açúcar e a variável dependente (Y) sendo a área plantada de cana de açúcar (representando uma proxy para a oferta do produto). O objetivo deste modelo é tentar quantificar a elasticidade da oferta em função do preço, ou seja, quantificar quão sensível é a oferta da cana de açúcar quando ocorre uma variações em seu preço. Os dados deste exercício estão no meu repositório do Github, vamos trazê-los com o comando abaixo, salvando-os na variável df (a.k.a data.frame):\ndf \u0026lt;- read.csv(file = \u0026quot;https://raw.githubusercontent.com/FranciscoPiccolo/franciscopiccolo.github.io/master/datasets/2019-09-05-residual_analysis_on_linear_regression_models/dataset_1.csv\u0026quot;, sep = \u0026quot;;\u0026quot;, dec = \u0026quot;,\u0026quot;)\rdim(df)\r## [1] 34 3\rCom a função dim podemos ver a dimensão deste dataset, com 34 registros e 3 colunas.\nThe data set for this example has 34 rows, with planted area and suggarcane price fields. Vamos ver uma amostra dos dados.\ndf[sample(nrow(df),5), ] %\u0026gt;%\ras_tibble()\r## # A tibble: 5 x 3\r## period area price\r## \u0026lt;int\u0026gt; \u0026lt;int\u0026gt; \u0026lt;dbl\u0026gt;\r## 1 31 171 0.360\r## 2 27 97 0.401\r## 3 29 197 0.353\r## 4 17 250 0.381\r## 5 20 162 0.230\rO modelo de regressão linear para este cenário será desenvolvido de acordo com a fórmula abaixo:\n\\[ lnY_t = \\beta_0+\\beta_1 (lnX_t) + \\mu_t \\]\nOnde:\n\\(Y_t\\) = Área plantada após a transformação com log natural (e)\n\\(X_t\\) = Preço da cana de açúcar também após a transformação com log natural\n\\(\\beta_0\\) = Intercepto\n\\(\\beta_1\\) = Inclinação\n\\(\\mu_t\\) = Resíduos\nOs dados precisam ter a aplicação do log natural, pois esta transformação faz com que as variações entre os períodos possam ser interpretadas como variações percentuais, e isso é necessário por conta de que a elasticidade é quantificada em termos percentuais. Esta característica ocorre apenas na transformação com logarítmo natural, se a transformação fosse feita com outros logs, a interpretação não seria válida.\nO gráfico abaixo irá mostrar o comportamento das variáveis do dataset, bem como a curva de regressão linear, antes de aplicar a transformação log natural.\ndf %\u0026gt;% ggplot()+\rgeom_point(mapping = aes(x = price, y = area), shape = 2)+\rgeom_smooth(mapping = aes(x = price, y = area), method = \u0026quot;lm\u0026quot;, formula = y ~ x, se = F, lty = 2,\rcolor = \u0026quot;dark orange\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Gráfico de dispersão das variáveis\u0026quot;,\rx = \u0026quot;Preço da Cana de Açúcar\u0026quot;,\ry = \u0026quot;Área Plantada\u0026quot;)\rPodemos ver que há uma relação entre o preço do produto e sua oferta. Agora vamos aplicar o log natural no modelo de regressão. Para isso, o R nos fornece duas opções:\n\rAjustar as variáveis no dataset e construir o modelo usando as variáveis ajustadas.\n\rConstruir o modelo e indicar “dentro dele” que é necessário fazer a transformação antes de computar os resultados.\n\r\rVamos ver na prática como cada opção pode ser usada. O resultado final será idêntico.\nPrimeiro vou criar duas variáveis com os resultados dos dois métodos:\n# Método 1, criando novos campos no dataset com a transformação log (e)\rfirst_method \u0026lt;- df %\u0026gt;% mutate(area_log = log(area),\rprice_log = log(price)) %\u0026gt;% lm(formula = area_log ~ price_log)\rsecond_method \u0026lt;- df %\u0026gt;% lm(formula = log(area) ~ log(price))\rCom as duas variáveis criadas, vamos criar uma tabela comparando os principais resultados dos modelos:\ndata.frame(\u0026quot;1º Método\u0026quot; = c(first_method$coefficients),\r\u0026quot;2º Método\u0026quot; = c(second_method$coefficients))\r## X1º.Método X2º.Método\r## (Intercept) 6.1113284 6.1113284\r## price_log 0.9705823 0.9705823\rConforme indicado, ambos os métodos geram o mesmo valor. Eu prefiro o segundo, que exige menos linhas de código. Com base nos coeficientes estimados, temos a seguinte equação:\n\\[\\hat{Y} = 1.6416 + 0.9706X_1 + \\mu\\]\nO resultado é estatisticamente significativo, visto que tanto o intercepto quanto a inclinação apresentam um valor-p baixo. Veja abaixo estes valores bem como o R².\nsecond_method %\u0026gt;% summary()\r## ## Call:\r## lm(formula = log(area) ~ log(price), data = .)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.65076 -0.18823 -0.03096 0.24914 0.60492 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 6.1113 0.1686 36.254 \u0026lt; 2e-16 ***\r## log(price) 0.9706 0.1106 8.773 5.03e-10 ***\r## ---\r## Signif. codes: 0 \u0026#39;***\u0026#39; 0.001 \u0026#39;**\u0026#39; 0.01 \u0026#39;*\u0026#39; 0.05 \u0026#39;.\u0026#39; 0.1 \u0026#39; \u0026#39; 1\r## ## Residual standard error: 0.3088 on 32 degrees of freedom\r## Multiple R-squared: 0.7063, Adjusted R-squared: 0.6972 ## F-statistic: 76.97 on 1 and 32 DF, p-value: 5.031e-10\rApesar destes dados mostrarem que a reta se ajustou bem aos dados e que o modelo consegue explicar ~70% da variação na variável dependente, é preciso anda analisar os resíduos para poder ter confiança no resultado para fazer projeções. No gráfico abaixo, vamos ver como se distribui os resíduos do modelo.\nmodel_residuals \u0026lt;- data.frame(values = second_method$residuals)\rEu opto primeiro por analisar um histograma dos reísduos, pois ele indicará se a distribuição se assemelha a uma distribuição normal. Vamos ver isso no gráfico abaixo.\n# Histogram\rmodel_residuals %\u0026gt;% ggplot()+\rgeom_histogram(mapping = aes(x = values), fill = \u0026quot;steel blue\u0026quot;)+\rtheme_graph()+\rlabs(title = \u0026quot;Distribuição dos Resíduos\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\r## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\rAparentemente os resíduos se distribuem normalmente. Outro gráfico interessante para analisar é o q-q plot, que também indicará quão parecido com a distribuição normal é a distribuição de uma variável.\n# q-q plot\rmodel_residuals %\u0026gt;% ggplot()+\rgeom_qq(mapping = aes(sample = values))+\rtheme_graph()+\rlabs(title = \u0026quot;Residuals\u0026#39; Q-Q plot\u0026quot;,\rx = \u0026quot;\u0026quot;,\ry = \u0026quot;\u0026quot;)\rEste gráfico também aponta para a ideia de resíduos normalmente distribuídos. Apesar de estes métodos serem bons e práticos, as vezes é necessário usar métodos formais para gerar alguma conclusão. Para validação da independência no comportamento dos resíduos pode-se usar o teste Durbin Watson. O código abaixo realiza este teste.\n# Necessário instalar e chamar o pacote \u0026#39;lmtest\u0026#39;\rlmtest::dwtest(df %\u0026gt;% lm(formula = log(area) ~ log(price)))\r## ## Durbin-Watson test\r## ## data: df %\u0026gt;% lm(formula = log(area) ~ log(price))\r## DW = 1.2912, p-value = 0.009801\r## alternative hypothesis: true autocorrelation is greater than 0\rO resultado do teste foi de 1.2912, mas apenas com este valor não é possível fazer uma conclusão. Em conjunto com este valor, é preciso saber os valores limiares DL e DU, que podem ser encontrados nesta tabela. Para encontrar os valores com esta tabela, basta saber o número de observações no dataset (i.e. n = 33), o nível de significância do teste (i.e. 0.05) e os graus de liberdade (i.e. 1). Com isso, tem-se:\nDL = 1.35\nDU = 1.49\nTendo DW igual a 1.2912, acima de 0 e abaixo de DL, pode-se concluir que os resíduos são independentes.\nCom isso, podemos concluir que de fato o modelo é confiável para realizar projeções, pois tanto os gráficos quanto o teste formal indicam que as premissas (iii) e (iv) estão sendo atendidas, como como as outras premissas. Desta forma, podemos concluir que há elasticidade na oferta de cana de açúcar com relação ao seu preço.\n\r","date":1567555200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1567555200,"objectID":"6f5d1a276652fb7fabbb1513fbd9e6fc","permalink":"https://francisco.piccolo.com/post/2019-09-05-residual-analysis-in-econometric-models/","publishdate":"2019-09-04T00:00:00Z","relpermalink":"/post/2019-09-05-residual-analysis-in-econometric-models/","section":"post","summary":"O modelo de regressão linear é bastante usado na predição de variáveis contínuas, onde há uma ou mais variáveis independentes buscando mapear o comportamento de uma variável dependente.","tags":null,"title":"Análise de Resíduos em Modelos de Regressão Linear","type":"post"}]